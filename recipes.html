
<!DOCTYPE html>
<html  >
<head>
  
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/tigress-white-128x101.png" type="image/x-icon">
  <meta name="description" content="Web Page Creator Description">
  
  
  <title>empty</title>
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/tether/tether.min.css">
  <link rel="stylesheet" href="assets/popup-overlay-plugin/style.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Rubik:300,400,500,600,700,800,900,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik:300,400,500,600,700,800,900,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
  <link rel="preload" as="style" href="assets/mobirise/css/tigress.css">       <link rel="stylesheet" href="assets/mobirise/css/tigress.css"        type="text/css">

  
 <style>
body {
  background-color: #ffffff;
  color: #000000
}
section {
  background-color: #ffffff;
  color: #000000
}
p {
   color: #767676
}
h3 {
   color: #767676
}
</style>

  
</head>
<body>
  
  <section class="menu cid-umo90uRXnp" once="menu" id="menu1-dh">

    

    <nav class="navbar navbar-expand beta-menu navbar-dropdown align-items-center navbar-fixed-top navbar-toggleable-sm">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>
        <div class="menu-logo">
            <div class="navbar-brand">
                <span class="navbar-logo">
                    <a href="index.html">
                         <img src="assets/images/tigress-white-copy-1-154x122.png" alt="" title="" style="height: 3.8rem;">
                    </a>
                </span>
                <span class="navbar-caption-wrap"><a class="navbar-caption text-white display-4" href="index.html">
                        Tigress</a></span>
            </div>
        </div>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true"><li class="nav-item">
                    <a class="nav-link link text-white display-4" href="index.html">
                        
                        Home</a>
                </li><li class="nav-item dropdown">
                    <a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">Usage</a><div class="dropdown-menu"><a class="text-white dropdown-item text-primary display-4" href="quickstart.html">Quickstart<br></a><a class="text-white dropdown-item text-primary display-4" href="mergeFiles.html">File merge<br></a><a class="text-white dropdown-item text-primary display-4" href="crossCompile.html">Cross compile</a><a class="text-white dropdown-item text-primary display-4" href="recipes.html">Recipes</a><a class="text-white dropdown-item text-primary display-4" href="recipies.html">Libraries</a><a class="text-white dropdown-item text-primary display-4" href="top-level.html">Top-Level Options</a><a class="text-white dropdown-item text-primary display-4" href="bugs.html">Issues</a><a class="text-white dropdown-item text-primary display-4" href="testing.html">Testing</a></div>
                </li><li class="nav-item dropdown"><a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">Platforms</a><div class="dropdown-menu"><a class="text-white dropdown-item text-primary display-4" href="linux.html">Linux<br></a><a class="text-white dropdown-item text-primary display-4" href="macos.html">MaxOS<br></a><a class="text-white dropdown-item text-primary display-4" href="windows.html">Windows<br></a><a class="text-white dropdown-item text-primary display-4" href="android.html">Android<br></a><a class="text-white dropdown-item text-primary display-4" href="wasm.html">WASM<br></a></div></li><li class="nav-item dropdown"><a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">Users</a><div class="dropdown-menu"><a class="text-white dropdown-item text-primary display-4" href="academics.html">For academics<br></a><a class="text-white dropdown-item text-primary display-4" href="students.html">For students<br></a><a class="text-white dropdown-item text-primary display-4" href="practitioners.html">For practitioners<br></a><a class="text-white dropdown-item text-primary display-4" href="developers.html">For developers<br></a></div></li><li class="nav-item dropdown"><a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">Transformations</a><div class="dropdown-menu"><a class="text-white dropdown-item text-primary display-4" href="control.html">Control</a><a class="text-white dropdown-item text-primary display-4" href="data.html">Data</a><a class="text-white dropdown-item text-primary display-4" href="functions.html">Functions</a><a class="text-white dropdown-item text-primary display-4" href="integrity.html">Integrity</a><a class="text-white dropdown-item text-primary display-4" href="environment.html">Environment</a><a class="text-white dropdown-item text-primary display-4" href="antiAnalysis.html">Anti analysis</a><a class="text-white dropdown-item text-primary display-4" href="other.html">Other</a></div></li><li class="nav-item dropdown"><a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">Info</a><div class="dropdown-menu"><a class="text-white dropdown-item text-primary display-4" href="news.html">News<br></a><a class="text-white dropdown-item text-primary display-4" href="blog.html">Blog<br></a><a class="text-white dropdown-item text-primary display-4" href="FAQ.html">FAQ</a><a class="text-white dropdown-item text-primary display-4" href="publications.html">Pubs<br></a></div></li><li class="nav-item dropdown"><a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">About</a><div class="dropdown-menu"><a class="text-white dropdown-item text-primary display-4" href="about.html">History<br></a><a class="text-white dropdown-item text-primary display-4" href="consulting.html">Training<br></a><a class="text-white dropdown-item text-primary display-4" href="contact.html">Contact</a></div></li><li class="nav-item"><a class="nav-link link text-white text-primary display-4" href="download4.html" aria-expanded="false">Download</a></li></ul>

        </div>
    </nav>
</section>


<br><br><br><br>



<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
Below are some simple recipes that will make it easy for you to get
started using Tigress. See them as a starting point for you to explore
all of Tigress' features, not as recommendations for particular
situations. Before using any kind of software protection technique
you must start with a detailed security analysis:

            </p>
        </div>
    </div>
</section>

<section class="mbr-section article content12 TIGRESS-UL" id="content12-dv">
    <div class="container">
        <div class="media-container-row">
            <div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
                <ul>

<li>
         What assets are you trying to protect?

</li>

<li>
         What is the value of those assets?

</li>

<li>
         For how long do you need to protect those assets?

</li>

<li>
         What is your performance budget?

</li>

<li>
         How does obfuscation fit into your overall security architecture?

</li>

<li>
         What are you adversary's goals and motivation?

</li>

<li>
         What are your adversary's tools and skill sets?

</li>

                </ul>
            </div>
        </div>
    </div>
</section>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
Only when you have answered these questions,
and have determined that obfuscation needs to be an integral part of
your architecture, can you start putting together Tigress
scripts. Over time we will add more recipes here. If you have found a
particular combination of Tigress transformations useful,
please <a href="https://tigress.wtf/contact.html">let us know</a>, and
we will add your recipe to the collection!

            </p>
        </div>
    </div>
</section>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
In the examples below we will be using these programs as input: <a href="test.c.txt">test.c</a>
and  <a href="test-jit.c.txt">test-jit.c</a>.

            </p>
        </div>
    </div>
</section>

<!-- =============================================================================================== -->

<section class="mbr-section content4 TIGRESS-SECTION" id="content4-dz">
    <div class="container">
        <div class="media-container-row">
            <div class="title col-12 col-md-8">
                <h2 class="align-center pb-3 mbr-fonts-style display-2">
 Recipe #1: Opaque Predicates, Branch Functions, and Encoded Arithmetic

               </h2>
            </div>
        </div>
    </div>
</section>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
Here is a simple recipe that should have a relatively low performance impact:

            </p>
        </div>
    </div>
</section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">tigress --Seed=42 --Statistics=0 --Verbosity=0 --Environment=x86_64:Darwin:Clang:5.1  \
     --Transform=InitEntropy \
        --Functions=init_tigress \
        --InitEntropyKinds=vars \
     --Transform=InitOpaque \
        --Functions=init_tigress \
        --InitOpaqueStructs=list,array,env  \
     --Transform=InitBranchFuns \
        --InitBranchFunsCount=1 \
     --Transform=AddOpaque \
        --Functions=fac,fib \
        --AddOpaqueStructs=list \
        --AddOpaqueKinds=true \
     --Transform=AntiBranchAnalysis \
       --Functions=fac,fib \
       --AntiBranchAnalysisKinds=branchFuns \
       --AntiBranchAnalysisObfuscateBranchFunCall=false \
       --AntiBranchAnalysisBranchFunFlatten=true \
     --Transform=EncodeArithmetic \
        --Functions=fac,fib  \
    test.c --out=output1.c 
</code></pre>
</center>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
Here is the <a href="output1.c.txt">resulting code.</a> There are a few things to note here:

            </p>
        </div>
    </div>
</section>

<section class="mbr-section article content12 TIGRESS-UL" id="content12-dv">
    <div class="container">
        <div class="media-container-row">
            <div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
                <ul>

<li>
      Most Tigress scripts require you to start off with a sequence of <tt>Init</tt>-transformations.
        In this case we have <tt>InitEntropy</tt>, <tt>InitOpaque</tt>, and <tt>InitBranchFuns</tt>. 
        This is admittedly annoying, but necessary, so that Tigress can create the types, variables, and functions
        necessary to transform the program. For example, <tt>InitBranchFuns</tt> creates one or more
           branch functions that the <tt>AntiBranchAnalysis</tt> transformation can use later on. 

</li>

<li>
      It is convenient, but not necessary, to create a special <tt>init_tigress</tt> function into
       which the <tt>Init</tt>-transformations can put initialization code. This function can then
          also be obfuscated to hide the initializations!

</li>

<li>
      <tt>--AntiBranchAnalysisBranchFunFlatten=true</tt> will flatten the code prior to inserting
       calls to branch functions. This is because branch functions operate on direct jumps (gotos), and
       most codes don't have many of those. After the flattening transformation, however, there are 
          many jumps to encode.

</li>

<li>
      If we instead set <tt>--Seed=0</tt> (which means the internal random number generator
       will be seeded with a new value every time Tigress is run), every time you run this script you
          will get a differently obfuscated program.

</li>

<li>
      The generated code starts off with a lot of seemingly random declarations. This is because
       Tigress is a whole program obfuscator: it starts by including all the .h files (including all
       system files) into one .c file that then becomes the input to the obfuscation process. If your
          program consists of multiple C-files you first need to merge them together using <tt>tigress-merge</tt>.

</li>

                </ul>
            </div>
        </div>
    </div>
</section>

<!-- =============================================================================================== -->

<section class="mbr-section content4 TIGRESS-SECTION" id="content4-dz">
    <div class="container">
        <div class="media-container-row">
            <div class="title col-12 col-md-8">
                <h2 class="align-center pb-3 mbr-fonts-style display-2">
 Recipe #2: Virtualization and Self-Modification

               </h2>
            </div>
        </div>
    </div>
</section>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
This transformation shows off a combination of two more powerful transformation, virtualization and
   self-modifying code, that together is likely to have serious performance impact:

            </p>
        </div>
    </div>
</section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">tigress --Seed=42 --Statistics=0 --Verbosity=0 --Environment=x86_64:Darwin:Clang:9.0  \
     --Transform=InitEntropy \
        --Functions=init_tigress \
        --InitEntropyKinds=vars \
     --Transform=InitOpaque \
        --Functions=init_tigress \
        --InitOpaqueStructs=list,array,env  \
     --Transform=Virtualize \
        --Skip=false \
        --VirtualizeDispatch=ifnest \
        --Functions=fac,fib \
     --Transform=SelfModify \
       --Skip=false \
       --Functions=fac,fib \
       --SelfModifySubExpressions=false \
       --SelfModifyBogusInstructions=10 \
    test.c --out=output2.c 
</code></pre>
</center>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
Here is the <a href="output2.c.txt">resulting code.</a> Here are a few things to note:

            </p>
        </div>
    </div>
</section>

<section class="mbr-section article content12 TIGRESS-UL" id="content12-dv">
    <div class="container">
        <div class="media-container-row">
            <div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
                <ul>

<li>
      The <tt>--Skip-false</tt> option is handy to turn transformations on-and-off to try out
          the impact of different transformations. 

</li>

<li>
         For more diversity, try different values for <tt>--VirtualizeDispatch</tt>.

</li>

<li>
      To compile this program you need to use <tt>gcc -segprot __TEXT rwx rwx output2.c -o output2.exe </tt>
       (on Darwin). See the <a href="selfModify.html">SelfModify</a> page for more information.

                </ul>
            </div>
        </div>
    </div>
</section>

<!-- =============================================================================================== -->


<section class="mbr-section content4 TIGRESS-SECTION" id="content4-dz">
    <div class="container">
        <div class="media-container-row">
            <div class="title col-12 col-md-8">
                <h2 class="align-center pb-3 mbr-fonts-style display-2">
 Recipe #3: Virtualization and Dynamic Obfuscation

               </h2>
            </div>
        </div>
    </div>
</section>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
In this recipe we first virtualize and then add dynamic obfusction; i.e. the program will
   decode and re-encode itself as it is running. In this particular case we decode/encode 
   using the XTEA cipher:
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">tigress --Seed=42 --Statistics=0 --Verbosity=0 --Environment=x86_64:Darwin:Clang:5.1  \
     --Transform=InitEntropy \
        --Functions=init_tigress \
        --InitEntropyKinds=vars \
     --Transform=InitOpaque \
        --Functions=init_tigress \
        --InitOpaqueStructs=list,array,env  \
     --Transform=Virtualize \
        --Skip=false \
        --VirtualizeDispatch=direct \
        --Functions=fib \
     --Transform=JitDynamic \
        --Skip=false \
        --Functions=fib \
        --JitDynamicCodecs=xtea \
        --JitDynamicBlockFraction=%100 \
     --Transform=Measure \
        --Functions=fib \
        --MeasureTimes=100 \
    test-jit.c --out=output3.c 
</code></pre>
</center>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
Here is the <a href="output3.c.txt">resulting code.</a> Here are a few things to note: 

            </p>
        </div>
    </div>
</section>

<section class="mbr-section article content12 TIGRESS-UL" id="content12-dv">
    <div class="container">
        <div class="media-container-row">
            <div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
                <ul>

<li>
      We use the <tt>Measure</tt> transformation along with differen values of <tt>Skip</tt> to
       measure the performance impact. On my machine virtualization alone takes 0.000192 seconds,
       dynamic obfuscation alone takes 0.077977 seconds, and together, the program slows down to
          2.125580 seconds!

</li>

<li>
      Setting <tt>--JitDynamicBlockFraction=1</tt> (which means only one basic block will be
          encoded) reduces the time to 1.800674 seconds.

</li>

                </ul>
            </div>
        </div>
    </div>
</section>

<!-- =============================================================================================== -->


<section class="mbr-section content4 TIGRESS-SECTION" id="content4-dz">
    <div class="container">
        <div class="media-container-row">
            <div class="title col-12 col-md-8">
                <h2 class="align-center pb-3 mbr-fonts-style display-2">
 Recipe #4: Merge, Virtualization, and Encode Literals

               </h2>
            </div>
        </div>
    </div>
</section>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
In this recipe we first merge all functions together. This includes <tt>init_tigress</tt> which has important
   secrets in it, in particular the initalization of opaque structures:
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">tigress --Seed=42 --Statistics=0 --Verbosity=1 --Environment=x86_64:Darwin:Clang:9.0  \
     --Transform=InitEntropy \
        --Functions=init_tigress \
        --InitEntropyKinds=vars \
     --Transform=InitOpaque \
        --Functions=init_tigress \
        --InitOpaqueStructs=list,array,env  \
     --Transform=Merge \
        --MergeFlatten=false \
        --MergeName=MERGED \
        --Functions=fib,fac,init_tigress \
     --Transform=Virtualize \
        --VirtualizeDispatch=direct \
        --Functions=MERGED \
     --Transform=EncodeLiterals \
        --Functions=main \
    test.c --out=output4.c 
</code></pre>
</center>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
Here is the <a href="output4.c.txt">resulting code.</a> Here are a few things to note: 

            </p>
        </div>
    </div>
</section>

<section class="mbr-section article content12 TIGRESS-UL" id="content12-dv">
    <div class="container">
        <div class="media-container-row">
            <div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
                <ul>

<li>
      There is no need to flatten the code in the merging process since we are going to 
          virtualize the resulting code anyway. So we set <tt>--MergeFlatten=false</tt> to save some on performance.

</li>

<li>
      Have a look at <tt>main</tt>: it now consists of 3 calls to <tt>MERGED</tt> rather than calls to
       the individual functions.</tt>

<li>
      Merging adds an extra argument so that we can know which function we're calling. This is a dead
       giveaway so we use the <tt>EncodeLiterals</tt> transformation to add some opaque expressions
          to the calls to <tt>MERGED</tt> in <tt>main</tt>

</li>

<li>
      Another possibility is add extra bogus arguments, using <tt>--Transform=RndArgs --Functions=MERGED --RndArgsBogusNo=10</tt>,
          which results in this <a href="output4a.c.txt">code.</a> 

</li>

                </ul>
            </div>
        </div>
    </div>
</section>
<!-- =============================================================================================== -->


<script src="assets/popper/popper.min.js"></script>
  <script src="assets/web/assets/jquery/jquery.min.js"></script>
  <script src="assets/bootstrap/js/bootstrap.min.js"></script>
  <script src="assets/tether/tether.min.js"></script>
  <script src="assets/smoothscroll/smooth-scroll.js"></script>
  <script src="assets/dropdown/js/nav-dropdown.js"></script>
  <script src="assets/dropdown/js/navbar-dropdown.js"></script>
  <script src="assets/touchswipe/jquery.touch-swipe.min.js"></script>
  <script src="assets/theme/js/script.js"></script>
  
  
  
</body>
</html>
