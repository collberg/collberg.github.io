<!DOCTYPE html>
<html  >
<head>
  <!-- Site made with Mobirise Website Builder v4.10.10, https://mobirise.com -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v4.10.10, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/tigress-white-128x101.png" type="image/x-icon">
  <meta name="description" content="Web Site Builder Description">
  
  <title>Plugins</title>
  <link rel="preload" as="style" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
<link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="preload" as="style" href="assets/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="preload" as="style" href="assets/bootstrap/css/bootstrap-grid.min.css">
<link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="preload" as="style" href="assets/bootstrap/css/bootstrap-reboot.min.css">
<link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/tether/tether.min.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/animatecss/animate.min.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
 
<style>
body {
  background-color: #ffffff;
  color: #000000
}
section {
  background-color: #ffffff;
  color: #000000
}
p {
   color: #767676
}
h3 {
   color: #767676
}
</style>

</head>
<body>

  <section class="menu cid-rCFaEeaKON" once="menu" id="menu1-v">

    

    <nav class="navbar navbar-expand beta-menu navbar-dropdown align-items-center navbar-fixed-top navbar-toggleable-sm">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>
        <div class="menu-logo">
            <div class="navbar-brand">
                <span class="navbar-logo">
                    <a href="index.html">
                         <img src="assets/images/tigress-white-copy-154x122.png" alt="Mobirise" title="" style="height: 3.8rem;">
                    </a>
                </span>
                <span class="navbar-caption-wrap"><a class="navbar-caption text-white display-4" href="index.html">
                        Tigress</a></span>
            </div>
        </div>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true"><li class="nav-item">
                    <a class="nav-link link text-white display-4" href="index.html">
                        
                        Home</a>
                </li><li class="nav-item">
                    <a class="nav-link link text-white display-4" href="introduction.html">
                        
                        Introduction</a>
</li><li class="nav-item"><a class="nav-link link text-white display-4" href="usage.html">Usage</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="transformations.html">Transformations</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="recipes.html">Recipes</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="publications.html">Publications</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="blog.html">Blog</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="FAQ.html">FAQ</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="consulting.html">Training</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="about.html">About</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="contact.html">Contact</a></li></ul>
            
        </div>
    </nav>
</section>

<br><br><br><br>
<center><h1>Plugins</h1></center>

<center><img width="500px" src="tigress3-images/plugins-front-page.png"></center>

<a class="anchor" id="plugins">&nbsp;</a>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2849" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Tigress has a simple way of letting you add code (we call
them <em>plugins</em>) that we can then incorporate into the
obfuscated program. For now, there are just two applications of
plugins: you can provide your own <em>responders</em>
  and <em>invariants</em> which are proprietary to you and unique
to your application.  Responders are code snippets that will be invoked
when there has been some sort of integrity violation, such as a 
checksum failure, and invariants are true facts about your code
that can be used to create opaque predicates. These are the 
available options:</p></div></div></section>

<center>
<div style="mbr-text align-left pb-3 mbr-fonts-style display-7">
<table border style="background-color:#f5f5f5;overflow-x:auto;color:black;width:80%;">
    <colgroup>
       <col span="1" style="width: 20%;">
       <col span="1" style="width: 20%;">
       <col span="1" style="width: 60%;">
    </colgroup>
<tr><th>Option</th><th>Arguments</th><th>Description</th></tr>
<tr>
<td><tt>--Transform</tt></td>
<td><tt>InitPlugins</tt></td>
<td> Initialize the plugin system. </td>
</tr>
<tr>
<td><tt>--InitPluginsInvariantPrefix</tt></td>
<td><tt><em>String</em></tt></td>
<td> The prefix for the name of invariant plugin functions. Default=NONE.</td>
</tr>
<tr>
<td><tt>--InitPluginsResponderPrefix</tt></td>
<td><tt><em>String</em></tt></td>
<td> The prefix for the name of responder plugin functions. Default=NONE.</td>
</tr>
</table>
</div>

</center>
</br>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2850" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff"> Plugin functions can take parameters. Two special parameters {\tt argc} and {\tt argv}
(of type <tt>int</tt> and <tt>char**</tt>, respectively) will be initialized with the 
arguments passed to <tt>main()</tt>. Any remaining formal parameters (which need to be
of arithmetic types) will be initialized with random local variables found where the 
plugin function is inserted. They can be read but should, obviously, not be modified,
unless you're writing a <em>responder</em> that you want to crash the program.</p></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2851" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">The plugin functions are only used during obfuscation and are removed from the resulting
program.</p></div></div></section>

<a class="anchor" id="invariants">&nbsp;</a>
<br>
<h3 align=center>Invariants</h3>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2852" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">The purpose of invariant plugins is to allow the application
developer to provide properties about the program that Tigress itself
would not be able to figure out. These properties can then be used in
Tigress transformations, often causing the program to crash or
misbehave if an adversary modifies the program such that the
invariants no longer hold.</p></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2853" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Invariant plugin functions should always return an int. The name of
an invariant plugin function should start with the <em>prefix</em>
(set by the <tt>--InitPluginsInvariantPrefix=<em>prefix</em></tt>
option) and be followed by an encoding of the value(s) the function
will return. These are the possible specifications:</p></div></div></section>
<section class="mbr-section article content12 cid-rDNq15ll1q" id="content12-d"><div class="container"><div class="media-container-row"><div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
<ul>
   <li><tt>ANY</tt> : the function returns an arbitrary value.</li>
   <li><tt>VALUE_<em>value</em></tt> : the function always returns the integer <em>value</em>.</li>
   <li><tt>MIN_<em>value</em></tt> : the function always returns an integer greater than or equal to <em>value</em>.</li>
   <li><tt>MAX_<em>value</em></tt> : the function always returns an integer less than or equal to <em>value</em>.</li>
   <li><tt>RANGE_<em>from</em>_<em>to</em></tt> : the function always returns an integer in the range <tt>[<em>from</em>, <em>to</em>]</tt>, inclusive.</li>
</ul>
</div></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2854" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">For example, if you have set <tt>--InitPluginsInvariantPrefix=<em>acme</em></tt> 
you could add the following function to your application: </p></div></div></section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">int highScore = 0;     /* Always less than 100! */
...
int acme_RANGE_0_99 (void) {
   return highScore;
}
</code></pre>
</center>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2855" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">The idea here is that transformations which use opaque predicates will
introduce code that assumes that <tt>0 &le; highScore &lt; 100</tt>. If
an attacker modifies the code so that <tt>highScore</tt> is outside of
this range, the program will start to misbehave.</p></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2856" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Here is how you would call Tigress with the <tt>AddOpaque</tt> transform:</p></div></div></section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">tigress \
           --Transform=InitPlugins  --InitPluginsInvariantPrefix=acme    \
           --Transform=InitOpaque --Functions=main --InitOpaqueStructs=plugin    \
           --Transform=AddOpaque \
              --Functions=* \
              --AddOpaqueKinds=true \
              --AddOpaqueStructs=plugin	\
</code></pre>
</center>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2857" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Here are some examples of invariant plugin functions:</p></div></div></section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">/* Returns a random value */
int acme_ANY (void) {
   return list_length(myList);
}

/* Returns 42. */
int acme_VALUE_42 (void) {
   return aes_key[4];
}

/* Returns 5. */
int acme_VALUE_5 (void) {
   return 5;
}

/* Returns a value in [10..]. */
int acme_MIN_10 () {
   return 10 + random();
}

/* Returns a value in [..10]. */
int acme_MAX_10 () {
   return (random() % 11);
}

/* Returns a value in [10..20]. */
int acme_RANGE_10_20 () {
   return 10 + (random() % 11);
}

/* Returns the length of the argument list, for a program
   that is expected to be called with 1,2, or 3 arguments . */
int acme_RANGE_1_3 (int argc) {
   return argc;
}
</code></pre>
</center>


<a class="anchor" id="responders">&nbsp;</a>
<br>
<h3 align=center>Responders</h3>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2858" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Tigress has a few simple built-in responders that can be used in the
<tt>Checksum</tt> transformation. With plugins, you can easily add
your own responders to your application. Responder plugin
functions should always return <tt>void</tt>.</p></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2859" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Here is how you would invoke Tigress to use your own plugin 
responders with the <tt>Checksum</tt> transform:</p></div></div></section>

<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">tigress \
         --Transform=InitPlugins  --InitPluginsResponderPrefix=acme_responder    \
         --Transform=Checksum ... --ChecksumResponseKinds=plugin ... \
         ...
</code></pre>
</center>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2860" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Here are some simple examples of responder plugins:</p></div></div></section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">void acme_responder_1 () {
   abort();
}
void acme_responder_2 (int argc, char** argv) {
   argv[argc-1] = '\0';
}
void acme_responder_3 () {
   for(int i=0; i<10; i++) {
      printf("Hacked %i!\n", i);
   }
   exit(-1);
}
void acme_responder_4 () {
   phone_home("We've been hacked!");
}

void acme_responder_5 () {
   memset(aes_key, 0, 16);
}
</code></pre>
</center>

<a class="anchor" id="opaque">&nbsp;</a>
<br>
<h3 align=center>Write Your Own Opaque Library!</h3>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2861" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Using plugins you can write your own opaque predicate library. Two more plugin functions are available to
facilitate this, <em>initialize</em> and <em>update</em>:</p></div></div></section>

<center>
<div style="mbr-text align-left pb-3 mbr-fonts-style display-7">
<table border style="background-color:#f5f5f5;overflow-x:auto;color:black;width:80%;">
    <colgroup>
       <col span="1" style="width: 20%;">
       <col span="1" style="width: 20%;">
       <col span="1" style="width: 60%;">
    </colgroup>
<tr><th>Option</th><th>Arguments</th><th>Description</th></tr>
<tr>
<td><tt>--Transform</tt></td>
<td><tt>InitPlugins</tt></td>
<td> Initialize the plugin system. </td>
</tr>
<tr>
<td><tt>--InitPluginsInvariantPrefix</tt></td>
<td><tt><em>String</em></tt></td>
<td> The prefix for the name of invariant plugin functions. Default=NONE.</td>
</tr>
<tr>
<td><tt>--InitPluginsInitializePrefix</tt></td>
<td><tt><em>String</em></tt></td>
<td> The prefix for the name of initializer plugin functions. Default=NONE.</td>
</tr>
<tr>
<td><tt>--InitPluginsUpdatePrefix</tt></td>
<td><tt><em>String</em></tt></td>
<td> The prefix for the name of update plugin functions. Default=NONE.</td>
</tr>
</table>
</div>

</center>
</br>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2862" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Here's a simple example of a library that you would add to the beginning of your application:</p></div></div></section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">int alwaysEven;

void acme_initialize_even (int argc) {
   alwaysEven = (argc+1) * 2;
}

void acme_update_even_1 () {
   alwaysEven += 2;
}

void acme_update_even_2 (int f) {
   alwaysEven += f + (f % 2);
}

int acme_invariant_even_VALUE_0 (void) {
   return alwaysEven%2;
}
</code></pre>
</center>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2863" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">This library adds a global variable <tt>alwaysEven</tt> which, as the name implies, is alwyas even.
The body of the <tt>initialize_even</tt> function will be inserted in the function where you want 
initializations to take place, and the two update functions will be inserted by the <tt>UpdateOpaque</tt>
transformation. Here is the call to Tigress:</p></div></div></section>

<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">tigress  ... \
     --Transform=InitPlugins  \
        --InitPluginsInvariantPrefix=acme_invariant    \
        --InitPluginsInitializePrefix=acme_initialize    \
        --InitPluginsUpdatePrefix=acme_update    \
     --Transform=InitOpaque   \
         --Functions=main \
          --InitOpaqueStructs=plugin    \
     --Transform=AddOpaque \
        --Functions=* \
        --AddOpaqueKinds=true \
        --AddOpaqueStructs=plugin \
     --Transform=UpdateOpaque \
        --Functions=* \
        --UpdateOpaqueCount=10 
</code></pre>
</center>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2864" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Below is another example which uses linked list to make an opaque predicate library.
There are two invariants that hold over this list: the list is always of even length 
and the elements of the list are always odd:<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c2865" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">typedef struct intList {
   struct intListNode* first;
} *INTLIST;

typedef struct intListNode {
   int value;
   struct intListNode* next;
} *INTLISTNODE;

typedef INTLIST intList_t;
typedef INTLISTNODE intListNode_t;

intList_t list;

void acme_initialize_list (int argc) {
   list = (intList_t) malloc(sizeof(struct intList));
   list->first = NULL;
   for(int i=0; i < (argc * 2); i++) {
      intListNode_t r = (intListNode_t) malloc(sizeof(struct intListNode));
      r->value = i*2+1;
      r->next = list->first;
      list->first = r;
   }
}

void acme_update_list (int v1, int v2) {
   intListNode_t r = (intListNode_t) malloc(sizeof(struct intListNode));
   r->value = v1*2+1;
   r->next = list->first;
   list->first = r;
   r = (intListNode_t) malloc(sizeof(struct intListNode));
   r->value = v2*4+1;
   r->next = list->first;
   list->first = r;
}

int acme_invariant_length_VALUE_0 () {
   int length = 0;
   intListNode_t i = list->first;
   while (i != NULL) {
     length++;
     i = i->next;
   };
   return length % 2;
}

int acme_invariant_odd_VALUE_0 (int v) {
   int value = 3;
   intListNode_t i = list->first;
   int times = v;
   while ((i != NULL) && (times > 0)) {
     value = i->value;
     times--;
     i = i->next;
   };
   return value % 2 - 1;
}
</code></pre>
</center>

  <script src="assets/popper/popper.min.js"></script>
  <script src="assets/bootstrap/js/bootstrap.min.js"></script>
  <script async src="assets/tether/tether.min.js"></script>
  <script async src="assets/dropdown/js/nav-dropdown.js"></script>
  <script async src="assets/dropdown/js/navbar-dropdown.js"></script>
  <script async src="assets/touchswipe/jquery.touch-swipe.min.js"></script>
  <script async src="assets/viewportchecker/jquery.viewportchecker.js"></script>
  <script async src="assets/smoothscroll/smooth-scroll.js"></script>
  <script async src="assets/theme/js/script.js"></script>
  
  
  <input name="animation" type="hidden">
  
</body>
</html>
