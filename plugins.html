<!DOCTYPE html>
<html  >
<head>
  <!-- Site made with Mobirise Website Builder v4.10.10, https://mobirise.com -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v4.10.10, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/tigress-white-128x101.png" type="image/x-icon">
  <meta name="description" content="Web Site Builder Description">
  
  <title>AddOpaque</title>
  <link rel="preload" as="style" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
<link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="preload" as="style" href="assets/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="preload" as="style" href="assets/bootstrap/css/bootstrap-grid.min.css">
<link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="preload" as="style" href="assets/bootstrap/css/bootstrap-reboot.min.css">
<link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/tether/tether.min.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/animatecss/animate.min.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
 
<style>
body {
  background-color: #ffffff;
  color: #000000
}
section {
  background-color: #ffffff;
  color: #000000
}
p {
   color: #767676
}
h3 {
   color: #767676
}
</style>

</head>
<body>

  <section class="menu cid-rCFaEeaKON" once="menu" id="menu1-v">

    

    <nav class="navbar navbar-expand beta-menu navbar-dropdown align-items-center navbar-fixed-top navbar-toggleable-sm">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>
        <div class="menu-logo">
            <div class="navbar-brand">
                <span class="navbar-logo">
                    <a href="index.html">
                         <img src="assets/images/tigress-white-copy-154x122.png" alt="Mobirise" title="" style="height: 3.8rem;">
                    </a>
                </span>
                <span class="navbar-caption-wrap"><a class="navbar-caption text-white display-4" href="index.html">
                        Tigress</a></span>
            </div>
        </div>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true"><li class="nav-item">
                    <a class="nav-link link text-white display-4" href="index.html">
                        
                        Home</a>
                </li><li class="nav-item">
                    <a class="nav-link link text-white display-4" href="introduction.html">
                        
                        Introduction</a>
</li><li class="nav-item"><a class="nav-link link text-white display-4" href="usage.html">Usage</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="transformations.html">Transformations</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="recipes.html">Recipes</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="publications.html">Publications</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="blog.html">Blog</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="FAQ.html">FAQ</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="consulting.html">Training</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="about.html">About</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="contact.html">Contact</a></li></ul>
            
        </div>
    </nav>
</section>

<br><br><br><br>
<center><h1>Plugins</h1></center>

<center><img width="500px" src="tigress3-images/plugins-front-page.png"></center>

<a class="anchor" id="plugins">&nbsp;</a>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c8204" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Tigress has a simple way of letting you add code (we call
them <em>plugins</em>) that we can then incorporate into the
obfuscated program. For now, there are just two applications of
plugins: you can provide your own <em>responders</em>
  and <em>invariants</em> which are proprietary to you and unique
to your application.  Responders are code snippets that be called
when there has been some sort of integrity violation, such as a 
checksum failire, and invariants are true facts about your code
which can be used to create opaque predicates.</p></div></div></section>

<center>
<div style="mbr-text align-left pb-3 mbr-fonts-style display-7">
<table border style="background-color:#f5f5f5;overflow-x:auto;color:black;width:80%;">
    <colgroup>
       <col span="1" style="width: 20%;">
       <col span="1" style="width: 20%;">
       <col span="1" style="width: 60%;">
    </colgroup>
<tr><th>Option</th><th>Arguments</th><th>Description</th></tr>
<tr>
<td><tt>--Transform</tt></td>
<td><tt>InitPlugins</tt></td>
<td> Initialize the plugin system. </td>
</tr>
<tr>
<td><tt>--InitPluginsInvariantPrefix</tt></td>
<td><tt><em>String</em></tt></td>
<td> The prefix for the name of invariant plugin functions. Default=1.</td>
</tr>
<tr>
<td><tt>--InitPluginsResponderPrefix</tt></td>
<td><tt><em>String</em></tt></td>
<td> The prefix for the name of responder plugin functions. Default=1.</td>
</tr>
</table>
</div>

</center>
</br>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c8205" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">The plugin functions are only used during obfuscation and are removed from the resulting
program.</p></div></div></section>

<a class="anchor" id="invariants">&nbsp;</a>
<br>
<h3 align=center>Invariants</h3>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c8206" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Invariant plugin functions should always return an int, and can have zero parameters, or
two parameters <tt>(int argc, char** argv)</tt>. In the latter case, <tt>argc</tt> and 
<tt>argv</tt> will contain the command line arguments to the program, just like <tt>main</tt>.
The name of a plugin function should start with the <em>prefix</em> set by the 
<tt>--InitPluginsInvariantPrefix=<em>prefix_string</em></tt> option. The prefix should be followed by
a specification of what the function returns. These are the options:</p></div></div></section>
<section class="mbr-section article content12 cid-rDNq15ll1q" id="content12-d"><div class="container"><div class="media-container-row"><div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
<ul>
   <li><tt>ANY</tt>: the function returns an arbitrary value.</li>
   <li><tt>VALUE_<em>value</em></tt>: the function always returns <em>value</em>.</li>
   <li><tt>MIN_<em>value</em></tt>: the function always returns a value greater than or equal to <em>value</em>.</li>
   <li><tt>MAX_<em>value</em></tt>: the function always returns a value less than or equal to <em>value</em>.</li>
   <li><tt>RANGE_<em>from</em>_<em>to</em></tt>: the function always returns a value between <em>from</em> and  <em>to</em>, inclusive.</li>
</ul>
</div></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c8207" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">The purpose of these invariant plugins is to provide properties about the
program that Tigress itself would not be able to figure out. These properties
can then be used in Tigress transformations, often causing the program
to crash or misbehave if an adversary were to violate the invariants.</p></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c8208" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Here is how you would call tigress with the <tt>AddOpaque</tt> transform:</p></div></div></section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">tigress \
           --Transform=InitPlugins  --InitPluginsInvariantPrefix=invariant    \
           --Transform=InitOpaque --Functions=main --InitOpaqueStructs=plugin    \
           --Transform=AddOpaque \
              --Functions=* \
              --AddOpaqueKinds=true \
              --AddOpaqueStructs=plugin	\
</code></pre>
</center>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c8209" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Here are some examples:</p></div></div></section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">/* Returns a random value */
int invariant_ANY (void) {
   return list_length(myList);
}

/* Returns 42. */
int invariant_VALUE_42 (void) {
   return aes_key[4];
}

/* Returns 5. */
int invariant_VALUE_5 (void) {
   return 5;
}

/* Returns a value in [10..]. */
int invariant_MIN_10 (int argc, char** argv) {
   return 10 + random();
}

/* Returns a value in [10..]. */
int invariant_MAX_10 (int argc, char** argv) {
   return (random() % 11);
}

/* Returns a value in [10..]. */
int invariant_RANGE_10_20 (int argc, char** argv) {
   return 10 + (random() % 11);
}

/* Returns the length of the argument list, for a program
   that is expected to be called with 1,2, or 3 arguments . */
int invariant_RANGE_1_3 (int argc, char** argv) {
   return argc;
}
</code></pre>
</center>


<a class="anchor" id="responders">&nbsp;</a>
<br>
<h3 align=center>Responders</h3>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c8210" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Tigress has a few simple built-in responders that can be used in the
<tt>Checksum</tt> transformation. With plugins, you can easily add your own 
by adding a few functions to your input program. These functions should
return <tt>void</tt>, and can have zero or two <tt>(int argc, char** argv)</tt>
parameters.</p></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c8211" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Here is how you would call tigress with the <tt>Checksum</tt> transform:</p></div></div></section>

<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">tigress \
         --Transform=InitPlugins  --InitPluginsResponderPrefix=responder    \
         --Transform=Checksum ... --ChecksumResponseKinds=plugin ... \
         ...
</code></pre>
</center>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c8212" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Here are some examples:</p></div></div></section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">void responder_1 () {
   abort();
}
void responder_2 (int argc, char** argv) {
   argc[argc-1] = '\0';
}
void responder_3 () {
   for(int i=0; i<10; i++) {
      printf("Hacked %i!\n", i);
   }
   exit(-1);
}
void responder_4 () {
   phone_home("We've been hacked!");
}

void responder_5 () {
   memset(aes_key, 0, 16);
}
</code></pre>
</center>


  <script src="assets/popper/popper.min.js"></script>
  <script src="assets/bootstrap/js/bootstrap.min.js"></script>
  <script async src="assets/tether/tether.min.js"></script>
  <script async src="assets/dropdown/js/nav-dropdown.js"></script>
  <script async src="assets/dropdown/js/navbar-dropdown.js"></script>
  <script async src="assets/touchswipe/jquery.touch-swipe.min.js"></script>
  <script async src="assets/viewportchecker/jquery.viewportchecker.js"></script>
  <script async src="assets/smoothscroll/smooth-scroll.js"></script>
  <script async src="assets/theme/js/script.js"></script>
  
  
  <input name="animation" type="hidden">
  
</body>
</html>
