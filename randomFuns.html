
<!DOCTYPE html>
<html  >
<head>
  
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/tigress-white-128x101.png" type="image/x-icon">
  <meta name="description" content="Web Page Creator Description">
  
  
  <title>empty</title>
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/tether/tether.min.css">
  <link rel="stylesheet" href="assets/popup-overlay-plugin/style.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Rubik:300,400,500,600,700,800,900,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik:300,400,500,600,700,800,900,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
  <link rel="preload" as="style" href="assets/mobirise/css/tigress.css">       <link rel="stylesheet" href="assets/mobirise/css/tigress.css"        type="text/css">

  
 <style>
body {
  background-color: #ffffff;
  color: #000000
}
section {
  background-color: #ffffff;
  color: #000000
}
p {
   color: #767676
}
h3 {
   color: #767676
}
code {
  font-family:     "Courier New"
                    Courier
                    monospace;
  color: black;
}

</style>

  
</head>
<body>
  
  <section class="menu cid-umo90uRXnp" once="menu" id="menu1-dh">

    

    <nav class="navbar navbar-expand beta-menu navbar-dropdown align-items-center navbar-fixed-top navbar-toggleable-sm">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>
        <div class="menu-logo">
            <div class="navbar-brand">
                <span class="navbar-logo">
                    <a href="index.html">
                         <img src="assets/images/tigress-white-copy-1-154x122.png" alt="" title="" style="height: 3.8rem;">
                    </a>
                </span>
                <span class="navbar-caption-wrap"><a class="navbar-caption text-white display-4" href="index.html">
                        Tigress</a></span>
            </div>
        </div>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true"><li class="nav-item">
                    <a class="nav-link link text-white display-4" href="index.html">
                        
                        Home</a>
                </li><li class="nav-item dropdown">
                    <a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">Usage</a><div class="dropdown-menu"><a class="text-white dropdown-item text-primary display-4" href="quickstart.html">Quickstart<br></a><a class="text-white dropdown-item text-primary display-4" href="mergeFiles.html">File merge<br></a><a class="text-white dropdown-item text-primary display-4" href="crossCompile.html">Cross compile</a><a class="text-white dropdown-item text-primary display-4" href="recipes.html">Recipes</a><a class="text-white dropdown-item text-primary display-4" href="recipies.html">Libraries</a><a class="text-white dropdown-item text-primary display-4" href="top-level.html">Top-Level Options</a><a class="text-white dropdown-item text-primary display-4" href="bugs.html">Issues</a><a class="text-white dropdown-item text-primary display-4" href="testing.html">Testing</a></div>
                </li><li class="nav-item dropdown"><a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">Platforms</a><div class="dropdown-menu"><a class="text-white dropdown-item text-primary display-4" href="linux.html">Linux<br></a><a class="text-white dropdown-item text-primary display-4" href="macos.html">MaxOS<br></a><a class="text-white dropdown-item text-primary display-4" href="windows.html">Windows<br></a><a class="text-white dropdown-item text-primary display-4" href="android.html">Android<br></a><a class="text-white dropdown-item text-primary display-4" href="wasm.html">WASM<br></a></div></li><li class="nav-item dropdown"><a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">Users</a><div class="dropdown-menu"><a class="text-white dropdown-item text-primary display-4" href="academics.html">For academics<br></a><a class="text-white dropdown-item text-primary display-4" href="students.html">For students<br></a><a class="text-white dropdown-item text-primary display-4" href="practitioners.html">For practitioners<br></a><a class="text-white dropdown-item text-primary display-4" href="developers.html">For developers<br></a></div></li><li class="nav-item dropdown"><a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">Transformations</a><div class="dropdown-menu"><a class="text-white dropdown-item text-primary display-4" href="control.html">Control</a><a class="text-white dropdown-item text-primary display-4" href="data.html">Data</a><a class="text-white dropdown-item text-primary display-4" href="functions.html">Functions</a><a class="text-white dropdown-item text-primary display-4" href="integrity.html">Integrity</a><a class="text-white dropdown-item text-primary display-4" href="environment.html">Environment</a><a class="text-white dropdown-item text-primary display-4" href="antiAnalysis.html">Anti analysis</a><a class="text-white dropdown-item text-primary display-4" href="other.html">Other</a></div></li><li class="nav-item dropdown"><a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">Info</a><div class="dropdown-menu"><a class="text-white dropdown-item text-primary display-4" href="news.html">News<br></a><a class="text-white dropdown-item text-primary display-4" href="blog.html">Blog<br></a><a class="text-white dropdown-item text-primary display-4" href="FAQ.html">FAQ</a><a class="text-white dropdown-item text-primary display-4" href="publications.html">Pubs<br></a></div></li><li class="nav-item dropdown"><a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">About</a><div class="dropdown-menu"><a class="text-white dropdown-item text-primary display-4" href="about.html">History<br></a><a class="text-white dropdown-item text-primary display-4" href="consulting.html">Training<br></a><a class="text-white dropdown-item text-primary display-4" href="contact.html">Contact</a></div></li><li class="nav-item"><a class="nav-link link text-white text-primary display-4" href="download4.html" aria-expanded="false">Download</a></li></ul>

        </div>
    </nav>
</section>


<br><br><br><br>

<section class="mbr-section content4 TIGRESS-TITLE" id="content4-dz">
    <div class="container">
        <div class="media-container-row">
            <div class="title col-12 col-md-8">
                <h2 class="align-center pb-3 mbr-fonts-style display-2">
 Random Function

               </h2>
            </div>
        </div>
    </div>
</section>

<center><img width="500px" src="tigress3-images/randomFuns-front-page.png"></center>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
One of the uses of Tigress is as an educational tool. The <code>--Transform=RandomFuns</code>
option will generate a random function that can subsequently be transformed using any
combination of Tigress obfuscations, and then given to students as a cracking target.

            </p>
        </div>
    </div>
</section>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
You can use this transformation to generate a program for the students to reverse engineer:

            </p>
        </div>
    </div>
</section>
   <center><img width="400px" src="tigress3-images/generate-randomFuns.png"></center>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
By using different seeds you can generate unique challenges for each student:

            </p>
        </div>
    </div>
</section>
   <center><img width="400px" src="tigress3-images/generation-multiple.png"></center>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
Depending on the sophistication of your students, you can vary the length of the transformation
sequence, the difficulty of the transformations, the options to the transformations, 
the complexity of the generated challenge function, and either give them source to untangle
(a good way to learn about particular transformations), or stripped compiled code (for a more
real-world challenge).

            </p>
        </div>
    </div>
</section>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
We typically give each student 3 programs, of different levels of difficulty,
to attack. Thanks to the diversity of Tigress-generated programs, each challenge
is unique, making it harder for students to cheat. 

            </p>
        </div>
    </div>
</section>

<a class="anchor" id="examples">&nbsp;</a>

<section class="mbr-section content4 TIGRESS-SECTION" id="content4-dz">
    <div class="container">
        <div class="media-container-row">
            <div class="title col-12 col-md-8">
                <h2 class="align-center pb-3 mbr-fonts-style display-2">
 Examples

               </h2>
            </div>
        </div>
    </div>
</section>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
Below is part of the script we use to generate take-home exams for our students.
It contains two <em>assets</em>, a password check and an expired time check, 
and it's the students' job to disable these.

            </p>
        </div>
    </div>
</section>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
Start by creating this file, <code>empty.c</code>:

            </p>
        </div>
    </div>
</section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">#include "tigress.h"
#include &lt;stdio.h&gt; 
#include &lt;time.h&gt;
#include &lt;pthread.h&gt;
</code></pre>
</center>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
Generate the cleartext challenge program. This is hidden from the students:

            </p>
        </div>
    </div>
</section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">tigress --Verbosity=1 --Seed=$seed6 --Environment=x86_64:Darwin:Clang:5.1 \
      --Transform=RandomFuns \
         --RandomFunsName=SECRET \
         --Verbosity=5 \
         --RandomFunsFunctionCount=1 \
         --RandomFunsTrace=0 \
         --RandomFunsType=long \
         --RandomFunsInputSize=1 \
         --RandomFunsLocalStaticStateSize=1 \
         --RandomFunsGlobalStaticStateSize=0 \
         --RandomFunsLocalDynamicStateSize=0 \
         --RandomFunsGlobalDynamicStateSize=0 \
         --RandomFunsBoolSize=2 \
         --RandomFunsLoopSize=1000 \
         --RandomFunsCodeSize=100 \
         --RandomFunsOutputSize=1 \
         --RandomFunsTimeCheckCount=1 \
         --RandomFunsActivationCodeCheckCount=1 \
         --RandomFunsActivationCode=42 \
         --RandomFunsPasswordCheckCount=1 \
         --RandomFunsPassword=secret \
         --RandomFunsFailureKind=segv \
      --out=6-input.c empty.c
</code></pre>
</center>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
Next, generate an empty program with the same interface as the challenge program
for the students to fill out:

            </p>
        </div>
    </div>
</section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">tigress --Verbosity=1 --Seed=$seed6 \
      --Transform=RandomFuns --RandomFunsName=SECRET \
         --RandomFunsType=long \
         --RandomFunsInputSize=1 \
         --RandomFunsLocalStaticStateSize=1 \
         --RandomFunsGlobalStaticStateSize=0 \
         --RandomFunsLocalDynamicStateSize=0 \
         --RandomFunsGlobalDynamicStateSize=0 \
         --RandomFunsOutputSize=1 \
         --RandomFunsCodeSize=0 \
      --out=6-answer.c empty.c
</code></pre>
</center>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
Finally, obfuscate the challenge program: 

            </p>
        </div>
    </div>
</section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">tigress --Verbosity=1 --Seed=$seed6 --FilePrefix=obf \
      --Transform=InitEntropy \
         --Functions=main\
      --Transform=InitOpaque \
         --Functions=main --InitOpaqueCount=1 --InitOpaqueStructs=list,array\
      --Transform=InitBranchFuns \
         --InitBranchFunsCount=2\
      --Transform=EncodeLiterals \
         --Functions=SECRET --EncodeLiteralsKinds=string --EncodeLiteralsEncoderName=STRINGS\
      --Transform=Virtualize \
         --Functions=STRINGS --VirtualizeDispatch=switch --VirtualizeOperands=stack,registers \
         --VirtualizeMaxMergeLength=2 --VirtualizeSuperOpsRatio=1.0 \
      --Transform=AddOpaque \
         --Functions=SECRET --AddOpaqueKinds=call,bug,true --AddOpaqueCount=4\
      --Transform=Virtualize \
         --Functions=SECRET --VirtualizeDispatch=indirect --VirtualizeOperands=stack,registers \
         --VirtualizeMaxMergeLength=2 --VirtualizeSuperOpsRatio=1.0 \
      --Transform=Virtualize \
         --Functions=SECRET --VirtualizeDispatch=ifnest --VirtualizeOperands=stack,registers \
         --VirtualizeMaxMergeLength=2 --VirtualizeSuperOpsRatio=1.0 --VirtualizeNumberOfBogusFuns=1\
      --Transform=EncodeLiterals \
         --Functions=SECRET --EncodeLiteralsKinds=integer \
       --Transform=BranchFuns \
         --Functions=SECRET --BranchFunsFlatten=true \
      --Transform=CleanUp \
         --CleanUpKinds=annotations,constants,names \
      --out=6-challenge.c 6-input.c
</code></pre>
</center>

<a class="anchor" id="structure">&nbsp;</a>

<section class="mbr-section content4 TIGRESS-SECTION" id="content4-dz">
    <div class="container">
        <div class="media-container-row">
            <div class="title col-12 col-md-8">
                <h2 class="align-center pb-3 mbr-fonts-style display-2">
 Structure of Random Programs

               </h2>
            </div>
        </div>
    </div>
</section>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
To fulfill our needs, a random program generator must have certain characteristics:

            </p>
        </div>
    </div>
</section>

<section class="mbr-section article content12 TIGRESS-UL" id="content12-dv">
    <div class="container">
        <div class="media-container-row">
            <div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
                <ul>

<li>
        in order to make it easy for reverse engineers to automate attacks, the 
        generated programs must a have simple I/O behavior;

</li>

<li>
        the generator must be able to produce an "infinite" sequence of different programs;

</li>

<li>
        generated programs should be small, but still have an "interesting" internal structure;

</li>

<li>
        generated programs should always terminate;
       d

</li>

<li>
        generate programs should terminate <em>within a reasonable timebound</em>;

</li>

<li>
        an adversary should not be able to guess the internals of a generated
        program by examining its input-output behavior;

</li>

<li>
        generated programs should be "minimal," i.e. there should not be a smaller
        program that has the same I/O behavior (this is so that it is obvious to
        the reverse engineer when they have` found the correct program).

</li>

                </ul>
            </div>
        </div>
    </div>
</section>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
The generated challenge programs all take the following simple form:

            </p>
        </div>
    </div>
</section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">#include &le;stdio.h&gt; 
#include &le;stdlib.h&gt;

void SECRET(unsigned long input[1] , unsigned long output[1] ) 
   ...
}
int main(int argc, char** argv) {
{ 
  unsigned long input[1] ;
  unsigned long output[1] ;
  int i5 ;
  unsigned long value6 ;
  int i7 ;
  }
  i5 = 0;
  while (i5 < 1) {
    value6 = strtoul(argv[i5 + 1], 0, 10);
    input[i5] = value6;
    i5 ++;
  }
  SECRET(input, output);
  i7 = 0;
  while (i7 < 1) {
    printf("%lu\n", output[i7]);
    i7 ++;
  }
} 
</code></pre>
</center>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
That is, a challenge program reads one or more longs from standard in, 
and produces one or more longs on standard out.

            </p>
        </div>
    </div>
</section>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
Internally, generated <code>SECRET</code> functions share the same basic structure:
an <em>expansion phase</em>, a <em>mixing phase</em>, and a <em>compression phase</em>:

            </p>
        </div>
    </div>
</section>

<section class="mbr-section article content12 TIGRESS-UL" id="content12-dv">
    <div class="container">
        <div class="media-container-row">
            <div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
                <ul>

<li>
      The expansion phase expands the input arguments into a (typically larger) state space.
       It is currently a sequence of assignment statements.

</li>

<li>
      The mixing phase perform operations on the state space. This is where
       we add control structures.

</li>

<li>
      The Compression phase compresses the state into the (typically smaller) output.
       It is currently a sequence of assignment statements.

</li>

                </ul>
            </div>
        </div>
    </div>
</section>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
Here is an example:

            </p>
        </div>
    </div>
</section>
<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">void SECRET(unsigned long input[1] , unsigned long output[1] ) { 
  unsigned long state[4] ;
  unsigned long local1 ;

  /* Expansion phase */
  state[0UL] = input[0UL] + 762537946UL;
  state[1UL] = input[0UL] | ((16601096UL << (state[0UL] % 16UL | 1UL)) | (16601096UL >> (64 - (state[0UL] % 16UL | 1UL))));
  state[2UL] = (input[0UL] ^ 643136481UL) ^ (state[0UL] + 292656718UL);
  state[3UL] = (input[0UL] << (((state[1UL] >> 4UL) & 15UL) | 1UL)) | (input[0UL] >> (64 - (((state[1UL] >> 4UL) & 15UL) | 1UL)));

  /* Mixing phase */
  local1 = 0UL;
  while (local1 < 3UL) {
    state[1UL] |= (state[2UL] & 15UL) << 3UL;
    state[local1 + 1UL] = state[local1];
    local1 += 2UL;
  }
  if ((state[0UL] | state[1UL]) > (state[2UL] | state[3UL])) {
    state[3UL] |= (state[1UL] & 31UL) << 3UL;
  } else {
    state[2UL] = state[0UL];
    state[3UL] |= (state[2UL] & 15UL) << 3UL;
  }
  state[0UL] = state[2UL];

  /* Compression phase */  
  output[0UL] = (state[0UL] << (state[1UL] % 8UL | 1UL)) << ((((state[2UL] << (state[3UL] % 8UL | 1UL)) >> 1UL) & 7UL) | 1UL);
}
</code></pre>
</center>

<center>
<div style="mbr-text align-left pb-3 mbr-fonts-style display-7">
<table border style="background-color:#f5f5f5;overflow-x:auto;color:black;width:80%;">
    <colgroup>
       <col span="1" style="width: 20%;">
       <col span="1" style="width: 20%;">
       <col span="1" style="width: 60%;">
    </colgroup>
<tr><th>Option</th><th>Arguments</th><th>Description</th></tr>
<tr>
<td><tt>--Transform</tt></td>
<td><tt>RandomFuns</tt></td>
<td> Generate a random function useful as an attack target. </td>
</tr>
<tr>
<td><tt>--RandomFunsFunctionCount</tt></td>
<td><tt><em><a href="top-level.html#INTSPEC">INTSPEC</a></em></tt></td>
<td> Number of functions to generate. Default=1.</td>
</tr>
<tr>
<td><tt>--RandomFunsTrace</tt></td>
<td><tt><em><a href="top-level.html#INTSPEC">INTSPEC</a></em></tt></td>
<td> Insert tracing in the generated program. 0=no tracing. 1=trace function entry and exit. 2=as 1, but also trace control points. 3=as 2, but also trace individual statements. 4=as 3, but also trace the values of the STATE variable at each statement. Default=0.</td>
</tr>
<tr>
<td><tt>--RandomFunsTraceAssets</tt></td>
<td><tt><em><a href="top-level.html#BOOLSPEC">BOOLSPEC</a></em></tt></td>
<td> Trace the state at each asset instance Default=0.</td>
</tr>
<tr>
<td><tt>--RandomFunsInputSize</tt></td>
<td><tt><em><a href="top-level.html#INTSPEC">INTSPEC</a></em></tt></td>
<td> Size of input. Default=1.</td>
</tr>
<tr>
<td><tt>--RandomFunsLocalStaticStateSize</tt></td>
<td><tt><em><a href="top-level.html#INTSPEC">INTSPEC</a></em></tt></td>
<td> Size of function-local static state. Default=1.</td>
</tr>
<tr>
<td><tt>--RandomFunsLocalDynamicStateSize</tt></td>
<td><tt><em><a href="top-level.html#INTSPEC">INTSPEC</a></em></tt></td>
<td> Size of function-local dynamic state, i.e. the number of linked structures (lists, trees, etc) that can be built. Default=0.</td>
</tr>
<tr>
<td><tt>--RandomFunsGlobalStaticStateSize</tt></td>
<td><tt><em><a href="top-level.html#INTSPEC">INTSPEC</a></em></tt></td>
<td> Size of global static state. Default=0.</td>
</tr>
<tr>
<td><tt>--RandomFunsGlobalDynamicStateSize</tt></td>
<td><tt><em><a href="top-level.html#INTSPEC">INTSPEC</a></em></tt></td>
<td> Size of global dynamic state, i.e. the number of linked structures (lists, trees, etc) that can be built. Default=0.</td>
</tr>
<tr>
<td><tt>--RandomFunsOutputSize</tt></td>
<td><tt><em><a href="top-level.html#INTSPEC">INTSPEC</a></em></tt></td>
<td> Size of output. Default=1.</td>
</tr>
<tr>
<td><tt>--RandomFunsCodeSize</tt></td>
<td><tt><em><a href="top-level.html#INTSPEC">INTSPEC</a></em></tt></td>
<td> Size of the generated code. This is the number of nodes in generated Abstract Syntax Tree. Default=10.</td>
</tr>
<tr>
<td><tt>--RandomFunsLoopSize</tt></td>
<td><tt><em><a href="top-level.html#INTSPEC">INTSPEC</a></em></tt></td>
<td> Maximum count of loop iterations. Used to control the length of execution. Default=None.</td>
</tr>
<tr>
<td><tt>--RandomFunsBoolSize</tt></td>
<td><tt><em><a href="top-level.html#INTSPEC">INTSPEC</a></em></tt></td>
<td> Size of boolean expressions, specifically the number of conjunctions and disjunctions (&& and ||) that are used to build up expressions. Default=1.</td>
</tr>
<tr>
<td><tt>--RandomFunsType</tt></td>
<td><tt>char, short, int, long, float, double</tt></td>
<td> Type of input/output/state. Default=long.
<ul>
   <li> <tt>char</tt> = C int type
   <li> <tt>short</tt> = C int type
   <li> <tt>int</tt> = C int type
   <li> <tt>long</tt> = C long type
   <li> <tt>float</tt> = C float type
   <li> <tt>double</tt> = C double type
</ul>
</td>
</tr>
<tr>
<td><tt>--RandomFunsName</tt></td>
<td><tt>string</tt></td>
<td> The name of the generated function. Default=SECRET.</td>
</tr>
<tr>
<td><tt>--RandomFunsFailureKind</tt></td>
<td><tt>message, abort, segv, random, assign</tt></td>
<td> The manner in which a triggered asset may fail. Comma-separated list. Default=segv.
<ul>
   <li> <tt>message</tt> = Print a message.
   <li> <tt>abort</tt> = Call the <tt>abort</tt> function.
   <li> <tt>segv</tt> = Die with a segmentation fault.
   <li> <tt>random</tt> = Insert some random bytes which, when executed, will probably cause the program to misbehave.
   <li> <tt>assign</tt> = Insert some random assignments that, when executed, are likely to cause the program to produce the wrong output.
</ul>
</td>
</tr>
<tr>
<td><tt>--RandomFunsInputKind</tt></td>
<td><tt>argv, stdin</tt></td>
<td> How inputs are read by the program, through the command line or stdin. Default=argv.
<ul>
   <li> <tt>argv</tt> = Enter input to the program on the command line.
   <li> <tt>stdin</tt> = Enter input to the program through stdin.
</ul>
</td>
</tr>
<tr>
<td><tt>--RandomFunsInputType</tt></td>
<td><tt>int, float, string</tt></td>
<td> What is the type of the input being read from the user. Default=int.
<ul>
   <li> <tt>int</tt> = Enter input as a decimal integer.
   <li> <tt>float</tt> = Enter input as decimal float.
   <li> <tt>string</tt> = Enter input as an ASCII string.
</ul>
</td>
</tr>
<tr>
<td><tt>--RandomFunsDummyFailure</tt></td>
<td><tt><em><a href="top-level.html#BOOLSPEC">BOOLSPEC</a></em></tt></td>
<td> Generates excatly the same code whether true or false, except the failure code is rendered impotent. In other words, <tt>--RandomFunsDummyFailure=true</tt> will have the failure code inserted, but inactive. Default=false.</td>
</tr>
<tr>
<td><tt>--RandomFunsTimeCheckCount</tt></td>
<td><tt>int</tt></td>
<td> The number of checks for expired time (<tt>gettimeofday() > someTimeInThePast</tt>) to be inserted in the program. Default=0.</td>
</tr>
<tr>
<td><tt>--RandomFunsActivationCodeCheckCount</tt></td>
<td><tt>int</tt></td>
<td> The number of checks for correct activation code to be inserted in the program. Default=0.</td>
</tr>
<tr>
<td><tt>--RandomFunsActivationCode</tt></td>
<td><tt>int</tt></td>
<td> The code the user has to enter (as the first command line arguments) to be allowed to run the program. Default=42.</td>
</tr>
<tr>
<td><tt>--RandomFunsSecurityCheckCount</tt></td>
<td><tt>int</tt></td>
<td> The number of security checks to be inserted in the program. Default=0.</td>
</tr>
<tr>
<td><tt>--RandomFunsSecurityCheckValues</tt></td>
<td><tt><em>S-Expression</em></tt></td>
<td> List of <tt>((asset# state index value) (asset# state index value) ...)</tt> where  where 'state' is one of <tt>[input,output,local,global]</tt>. <tt>(5 local 3 42)</tt> specifies that the point where asset number 5 is in the code, <tt>local[3]</tt> may have the value 42. Default=0.</td>
</tr>
<tr>
<td><tt>--RandomFunsPasswordCheckCount</tt></td>
<td><tt>int</tt></td>
<td> The number of checks for correct password to be inserted in the program. Probably only 0 and 1 make sense here, since the user will be prompted for a password once for every check. Default=0.</td>
</tr>
<tr>
<td><tt>--RandomFunsPassword</tt></td>
<td><tt>string</tt></td>
<td> The password the user has to enter (read from standard input) to be allowed to run the program. Default="42".</td>
</tr>
<tr>
<td><tt>--RandomFunsControlStructures</tt></td>
<td><tt>S-Expression</tt></td>
<td> If set, will define the nested control structures of the generated function. Otherwise, a random structure will be generated. The argument is an S-Expression, where each subexpression has one of the forms <tt>(bb INTSPEC)</tt> (for a basic block consisting of a certain number of assignment statements), <tt>(for <em>S-expression</em>)</tt> (for a for-loop with a given body), or <tt>(if <em>S-expression</em> <em>S-expression</em>)</tt> (for an if-statement with a given then and else part), or <tt>(switch <em>S-expression</em> <em>S-expression</em>)</tt> (for a switch-statement with a given list of cases and a default case). For example, <tt>--RandomFunsControlStructures='(for ((bb 4)))'</tt> will generate a body consisting of a for-loop with 4 assignment statements in the body. <tt>(for ((bb 4) (if ((bb 1)) ((bb 2)))))</tt> also puts an if-statement inside the loop. <tt>(for ((bb 4) (if ((bb 1)) ((for (bb 2))))))</tt> puts a for-loop inside the else-part of the if-statement. <tt>(switch ((bb 4) (if ((bb 1)) (bb 4))) (bb 4))</tt> creates a switch-statment with two cases (a basic block and an if-statement), and a basic block as the default case. Default=none.</td>
</tr>
<tr>
<td><tt>--RandomFunsBasicBlockSize</tt></td>
<td><tt><em><a href="top-level.html#INTSPEC">INTSPEC</a></em></tt></td>
<td> The size of basic blocks, when control structures are not explicitly specified using <tt>RandomFunsControlStructures</tt>. Default=3.</td>
</tr>
<tr>
<td><tt>--RandomFunsForBound</tt></td>
<td><tt>constant, input, boundedInput, boundedAny</tt></td>
<td> The allowable upper bound in a for-statement. Comma-separated list. Default=constant.
<ul>
   <li> <tt>constant</tt> = Literal integer.
   <li> <tt>input</tt> = Value from the input array, could cause index out of bounds.
   <li> <tt>boundedInput</tt> = Value from the input array, will not cause index out of bounds.
   <li> <tt>boundedAny</tt> = Value from the any source, will not cause index out of bounds.
</ul>
</td>
</tr>
<tr>
<td><tt>--RandomFunsOperators</tt></td>
<td><tt>PlusA, MinusA, Mult, Div, Mod, Shiftlt, Shiftrt, Lt, Gt, Le, Ge, Eq, Ne, BAnd, BXor, BOr, *</tt></td>
<td> The allowable operators in expressions. Comma-separated list. Default=all.
<ul>
   <li> <tt>PlusA</tt> = +
   <li> <tt>MinusA</tt> = -
   <li> <tt>Mult</tt> = *
   <li> <tt>Div</tt> = /
   <li> <tt>Mod</tt> = %
   <li> <tt>Shiftlt</tt> = <<
   <li> <tt>Shiftrt</tt> = >>
   <li> <tt>Lt</tt> = <
   <li> <tt>Gt</tt> = >
   <li> <tt>Le</tt> = =<
   <li> <tt>Ge</tt> = >=
   <li> <tt>Eq</tt> = ==
   <li> <tt>Ne</tt> = !=
   <li> <tt>BAnd</tt> = &
   <li> <tt>BXor</tt> = ^
   <li> <tt>BOr</tt> = |
   <li> <tt>*</tt> = all operators
</ul>
</td>
</tr>
<tr>
<td><tt>--RandomFunsPointTest</tt></td>
<td><tt>BOOL</tt></td>
<td> Add <tt>if (output[0] == 4242424242U) printf("You win!\n");</tt> after the call to the generated function. The idea is to replace (by hand) 4242424242U with one actual output of the function. This can be used as another reverse engineering challenge: "<em>Find an input for which the program prints <tt>"You win!</tt>.</em> Default=false.</td>
</tr>
</table>
</div>

</center>
</br>


<a class="anchor" id="issues">&nbsp;</a>

<section class="mbr-section content4 TIGRESS-SECTION" id="content4-dz">
    <div class="container">
        <div class="media-container-row">
            <div class="title col-12 col-md-8">
                <h2 class="align-center pb-3 mbr-fonts-style display-2">
 Plugin ADTs

               </h2>
            </div>
        </div>
    </div>
</section>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
If you set <tt>--RandomFunsPluginADTCount=...</tt>, we will include calls to your own Abstract Data Types (ADTs). 
You call Tigress like this: 

            </p>
        </div>
    </div>
</section>

<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">tigress --Verbosity=1 --Seed=$seed6 --FilePrefix=obf \
      --Transform=InitPlugins \
          --InitPluginsContainerPrefix=Set \
          --InitPluginsDictionaryPrefix=HashMap \
      --Transform=RandomFuns \
            --RandomFunsPluginADTCount=4 
            ... \
     --out=result.c plugins.c

</code></pre>
</center>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
wnere <tt>plugins.c<tt> looks like this:

            </p>
        </div>
    </div>
</section>

<center>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">#include "tigress.h"
#include <stdio.h> 
#include <time.h>
#include <pthread.h>
#include <stdlib.h>
#include <time.h>
#include <sys/time.h>

// Types for Sets.
typedef ... Set_TYPE;
typedef ... Set_ELEMENT;
typedef ... Set_ITER;

// Create and destroy a set
Set_TYPE Set_CREATE(){ ... }

// Insert and delete elements from the set.
void Set_INSERT(Set_TYPE a, Set_ELEMENT b) { ... }

// Query the set
int Set_MEMBER(Set_TYPE a, Set_ELEMENT b){ ... }
int Set_SIZE(Set_TYPE a){ ... }

// Iterate through the elements of the set. Here's the pattern to use:
// Set_ITER i = Set_FIRST(s);
// while not Set_DONE(s, i) {
//   Set_ELEMENT e = Set_GET(s,i);
//   Do something with e;
//   i = Set_NEXT(s,i);
// }
Set_ITER Set_FIRST(Set_TYPE a){ ... }
Set_ITER Set_NEXT(Set_TYPE a, Set_ITER n){ ... }
int Set_DONE(Set_TYPE a, Set_ITER n){ ... }
Set_ELEMENT Set_GET(Set_TYPE a, Set_ITER n){ ... }
</code></pre>
</center>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
This will insert random calls to the Set data structure in the generated code.

            </p>
        </div>
    </div>
</section>

<a class="anchor" id="issues">&nbsp;</a>

<section class="mbr-section content4 TIGRESS-SECTION" id="content4-dz">
    <div class="container">
        <div class="media-container-row">
            <div class="title col-12 col-md-8">
                <h2 class="align-center pb-3 mbr-fonts-style display-2">
 Issues

               </h2>
            </div>
        </div>
    </div>
</section>

<section class="mbr-section article content12 TIGRESS-UL" id="content12-dv">
    <div class="container">
        <div class="media-container-row">
            <div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
                <ul>

<li>
        Generating random functions is actually a really cool research problem! Generating a program that always
        terminates, finishes within a reasonable time, looks vaguely normal (i.e. could possibly have been
        written by a human), and has a unique and unpredictable I/O behavior (i.e. the code can't be derived
        from blackbox access), is decidedly non-trival.

</li>

<li>
        A good solution to this problem should be worthy of at least a master's thesis, for sure! 
        Email me! <code>(:</code>

</li>

<li>
        This implementation doesn't achieve any of the stated goals. In particular, it's hard to ensure that 
        all programs generated from the same script runs in a reasonable time. 

</li>

<li>
        Various options can be used to tweak the runtime, in particular <code>--RandomFunsLoopSize=1000</code>
        which bounds the number of loop iterations.

</li>

<li>
        If you're willing to set the control structures yourself using 
        <code>--RandomFunsControlStructures="(if (bb 5) (bb 2))"</code>, then the problem goes away.
        When these are generated automatically, however, there's always some risk that you'll
        wind up with <code>--RandomFunsControlStructures="(for (for (for (for (bb 4)))))"</code> which is
        likely to run forever. I try to mitigate this by reducing the
        loop size (set by <code>--RandomFunsLoopSize=1000</code>) by a factor of 10 for every 
        nesting level, but this doesn't help if looping is interprocedural (I don't currently
        check for this).

</li>

<li>
        The random call graphs are actually just trees. They should be DAGs, at least.

</li>

                </ul>
            </div>
        </div>
    </div>
</section>

<a class="anchor" id="references">&nbsp;</a>

<section class="mbr-section content4 TIGRESS-SECTION" id="content4-dz">
    <div class="container">
        <div class="media-container-row">
            <div class="title col-12 col-md-8">
                <h2 class="align-center pb-3 mbr-fonts-style display-2">
 References

               </h2>
            </div>
        </div>
    </div>
</section>

<section class="mbr-section article content12 TIGRESS-UL" id="content12-dv">
    <div class="container">
        <div class="media-container-row">
            <div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
                <ul>

<li>
      Random function generation is described in 
<a href="https://www.usenix.org/conference/usenixsecurity17/technical-sessions/presentation/banescu">
   Predicting the Resilience of Obfuscated Code Against Symbolic Execution Attacks via Machine Learning
</a> by Sebastian Banescu, Christian Collberg, and Alexander Pretschner, USENIX Security 2017.

</li>

<li>
      <a href="https://www.cs.utah.edu/~regehr/papers/pldi11-preprint.pdf">Finding and Understanding Bugs in C Compilers</a>
       by Xuejun Yang, Yang Chen, Eric Eide, John Regehr.

</li>

                </ul>
            </div>
        </div>
    </div>
</section>


<script src="assets/popper/popper.min.js"></script>
  <script src="assets/web/assets/jquery/jquery.min.js"></script>
  <script src="assets/bootstrap/js/bootstrap.min.js"></script>
  <script src="assets/tether/tether.min.js"></script>
  <script src="assets/smoothscroll/smooth-scroll.js"></script>
  <script src="assets/dropdown/js/nav-dropdown.js"></script>
  <script src="assets/dropdown/js/navbar-dropdown.js"></script>
  <script src="assets/touchswipe/jquery.touch-swipe.min.js"></script>
  <script src="assets/theme/js/script.js"></script>
  
  
  
</body>
</html>
