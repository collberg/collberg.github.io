
<!DOCTYPE html>
<html  >
<head>
  
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/tigress-white-128x101.png" type="image/x-icon">
  <meta name="description" content="Web Maker Description">
  
   <link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons-bold/mobirise-icons-bold.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/tether/tether.min.css">
  <link rel="stylesheet" href="assets/popup-overlay-plugin/style.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/socicon/css/styles.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Rubik:300,400,500,600,700,800,900,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik:300,400,500,600,700,800,900,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
  <link rel="preload" as="style" href="assets/mobirise/css/tigress.css"> <link rel="stylesheet" href="assets/mobirise/css/tigress.css" type="text/css">
  <link href="assets/prism/prism.css" rel="stylesheet" />

  
 <style>
body {
  background-color: #ffffff;
  color: #000000
}
section {
  background-color: #ffffff;
  color: #000000
}
p {
   color: #000000
}
h3 {
   color: #000000
}
code {
  font-family:     "Courier New"
                    Courier
                    monospace;
  color: black;
}

</style>
  
</head>
<body>
  
  <section class="menu cid-um5eFJALJY" once="menu" id="menu1-16">

        <nav class="navbar navbar-expand beta-menu navbar-dropdown align-items-center navbar-fixed-top navbar-toggleable-sm">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>
        <div class="menu-logo">
            <div class="navbar-brand">
                <span class="navbar-logo">
                    <a href="index.html">
                         <img src="assets/images/screenshot-2024-08-20-at-14.25.07-copy-126x121.png" alt="" title="" style="height: 4.1rem;">
                    </a>
                </span>
                <span class="navbar-caption-wrap"><a class="navbar-caption text-white display-4" href="index.html">
                        Tigress</a></span>
            </div>
        </div>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true">
   <li class="nav-item dropdown">
      <a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">Usage</a><div class="dropdown-menu">
      <a class="text-white dropdown-item text-primary display-4" href="tigress-quickstart.html">Quickstart<br></a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-mergeFiles.html">File merge<br></a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-crossCompile.html">Cross compile</a>
      <a class="text-white dropdown-item text-primary display-4" href="recipes.html">Recipes</a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-libraries.html">Libraries</a>
      <a class="text-white dropdown-item text-primary display-4" href="top-level.html">Top-Level Options</a>
      <a class="text-white dropdown-item text-primary display-4" href="plugins.html">Plugins</a>
      <a class="text-white dropdown-item text-primary display-4" href="issues.html">Issues</a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-test.html">Testing</a></div>
   </li>
   <li class="nav-item dropdown">
      <a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">Platforms</a><div class="dropdown-menu">
      <a class="text-white dropdown-item text-primary display-4" href="tigress-linux.html">Linux<br></a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-macos.html">MacOS<br></a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-windows.html">Windows<br></a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-android.html">Android<br></a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-wasm.html">WASM<br></a>
      <a class="text-white dropdown-item text-primary display-4" href="cpp.html">C++<br></a></div>
   </li>
   <li class="nav-item dropdown">
      <a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">Users</a><div class="dropdown-menu">
      <a class="text-white dropdown-item text-primary display-4" href="tigress-academics.html">For academics<br></a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-students.html">For students<br></a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-practitioners.html">For practitioners<br></a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-developers.html">For developers<br></a></div>
   </li>
   <li class="nav-item dropdown">
      <a class="nav-link link text-white dropdown-toggle display-4" href="#" aria-expanded="false" data-toggle="dropdown-submenu">News</a><div class="dropdown-menu">
      <a class="text-white dropdown-item text-primary display-4" href="tigress-news.html" aria-expanded="false">News</a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-blog.html" aria-expanded="false">Blog</a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-vendors.html" aria-expanded="false">Tools &amp; Vendors</a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-update3to4.html" aria-expanded="false">Updates v3 âžž v4</a></div>
   </li>
   <li class="nav-item dropdown">
      <a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">Transformations</a><div class="dropdown-menu">
      <a class="text-white dropdown-item text-primary display-4" href="control-transforms.html">Control</a>
      <a class="text-white dropdown-item text-primary display-4" href="data-transforms.html">Data</a>
      <a class="text-white dropdown-item text-primary display-4" href="functions-transforms.html">Functions</a>
      <a class="text-white dropdown-item text-primary display-4" href="integrity-transforms.html">Integrity</a>
      <a class="text-white dropdown-item text-primary display-4" href="antiAnalysis-transforms.html">Anti analysis</a>
      <a class="text-white dropdown-item text-primary display-4" href="other-transforms.html">Other</a></div>
   </li>
   <li class="nav-item dropdown">
      <a class="nav-link link text-white dropdown-toggle display-4" href="#" data-toggle="dropdown-submenu" aria-expanded="false">About</a><div class="dropdown-menu">
      <a class="text-white dropdown-item text-primary display-4" href="tigress-history.html">History<br></a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-faq.html">FAQ<br></a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-consulting.html">Training<br></a>
      <a class="text-white dropdown-item text-primary display-4" href="tigress-publications.html">Pubs</a></div>
   </li>
   <li class="nav-item">
      <a class="nav-link link text-white text-primary display-4" href="contact.html" aria-expanded="false"><span class="socicon socicon-mail mbr-iconfont mbr-iconfont-btn" style="color: rgb(255, 127, 159);"></span></a>
   </li>
   <li class="nav-item">
      <a class="nav-link link text-white text-primary display-4" href="tigress-download.html" aria-expanded="false"><span class="mbrib-download mbr-iconfont mbr-iconfont-btn" style="color: rgb(255, 127, 159);"></span></a>
   </li>
</ul>
            
        </div>
    </nav>

</section>

<br><br><br><br>

<section class="mbr-section content4 TIGRESS-TITLE" id="content4-dz">
    <div class="container">
        <div class="media-container-row">
            <div class="title col-12 col-md-8">
                <h2 class="align-center pb-3 mbr-fonts-style display-2">
<center><h1 style="font-size: 60px; font-weight:400"> InitCheckers<br>(Experimental)</h1></center>

               </h2>
            </div>
        </div>
    </div>
</section>

<center><img width="500px" src="tigress3-images//checkers-front-page.png"></center>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
This is the initialization transformation that should precede
the <a href="checksum.html">Checksum</a> and <a href="checkEnvironment.html">CheckEnvironment</a>
transformations. This transformation will create a set of global variables that checkers
will increment whenever a check fails.  It will also create a set of
responders which will trigger a response whenever the number of failed
checks exceed a threshold.  

            </p>
        </div>
    </div>
</section>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
As an example, consider this command:

            </p>
        </div>
    </div>
</section>
<div class="container">
<pre style="box-shadow: -5px 0 0 0 red, 0 0 0 1px #dfdfdf"><code class="language-bash">tigress --Environment=x86_64:Linux:Clang:5.1 \
    --Transform=InitChecker \
       --InitCheckersResponseKinds=abort \
       --InitCheckersResponderCount=2 \
       --InitCheckersStateSize=2 \
       --InitCheckersFakeSize=2 \
       --InitCheckersThreshold=2 \
       --InitCheckersStateEncodings=rnc,xor \
       --InitCheckersFunctionsToInvokeResponders=fib,fac \
       --Functions=main \
   --Transform=CheckEnvironment \
       --Functions=fac \
       --CheckEnvironmentSandboxes=valgrind \
       --CheckEnvironmentCheckerCount=2 \
   foo.c --out=obf.c
</code></pre></div><br>



<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
<code class="language-c">--Transform=InitChecker</code> will create global variables that will count the number of tests 
conducted and the number of tests that failed. You can also add fake variables to make it harder for 
the attacker to identify the real ones:

            </p>
        </div>
    </div>
</section>
<div class="container">
<pre><code class="language-c">int fail_1 = 0;
int fail_2 = 0;
int test_1 = 0;
int test_2 = 0;
int fake_1 = 0;
int fake_2 = 0;
</code></pre></div><br>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
In practice, we don't want these values in cleartext. The <code class="language-c">--InitCheckersStateEncodings</code> option decides
how the state variables should be encoded. Here's what the initialization looks like when you choose <em>Residue Number Coding</em>:

            </p>
        </div>
    </div>
</section>
<div class="container">
<pre><code class="language-c">long fail_1_0 = ((0L % 230135L ^ ~ (10L * 230135L)) + ((0L % 230135L | 10L * 230135L) + (0L % 230135L | 10L * 230135L))) + 1L;
long fail_1_1 = ((0L % 211253L | 10L * 211253L) << 1L) - (0L % 211253L ^ 10L * 211253L);
</code></pre></div><br>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
The <code class="language-c">--InitCheckersFunctionsToInvokeResponders</code> option decides into which functions the responders should 
be inserted.

            </p>
        </div>
    </div>
</section>


<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
The <code class="language-c">--Transform=CheckEnvironment</code> transformation will spread responders throughout the program.
The <code class="language-c">--CheckEnvironmentSandboxes</code> and <code class="language-c">--CheckEnvironmentCheckerCount</code> options 
decide what sandboxes we should check for, and how many checks we should insert. The <code class="language-c">--Functions</code> 
option decides into which functions the checkers should be inserted.
The responders look like this:

            </p>
        </div>
    </div>
</section>
<div class="container">
<pre><code class="language-c">  total4 = __1_counterState_fail_1_0;
  total4 += __1_counterState_fail_0_0;
  if (total4 > 2) {
    abort();
  } else {

  }
</code></pre></div><br>

<section class="header9 TIGRESS-P" id="header9-dw">
    <div class="container">
        <div class="media-container-column mbr-white">
            <p class="mbr-text align-left pb-3 mbr-fonts-style display-7">
I.e. we compute the total number of failed tests by adding up all the failure state variables, and, if the
total exceeds the <code class="language-c">--InitCheckersThreshold</code> value, we execute the response. With Residue Number Coding,
it looks like this:

            </p>
        </div>
    </div>
</section>
<div class="container">
<pre><code class="language-c">  decode4 = (((fail_1_0 * 16680518100L) % 24104988860L + (fail_1_1 * 7424470761L) % 24104988860L) % 24104988860L + 24104988860L) % 24104988860L;
  if (decode4 > 12052494429L) {
    decode4 -= 24104988860L;
  } else {

  }
  total5 = (int )decode4;
  decode6 = (((fail_0_0 * 7721719656L) % 48616709155L + (fail_0_1 * 40894989500L) % 48616709155L) % 48616709155L + 48616709155L) % 48616709155L;
  if (decode6 > 24308354576L) {
    decode6 -= 48616709155L;
  } else {

  }
  total5 += (int )decode6;
  if (total5 > 2) {
    abort();
  } else {

  }
</code></pre></div><br>


<section class="table2 TIGRESS-TABLE2" id="table2-dy">
<div class="container">
<div style="mbr-text align-left pb-3 mbr-fonts-style display-7">
<center>
<table border style="background-color:#ffffff;overflow-x:auto;color:black;width:90%;">
    <colgroup>
       <col span="1" style="width: 20%;">
       <col span="1" style="width: 20%;">
       <col span="1" style="width: 60%;">
    </colgroup>
<tr><th>Option</th><th>Arguments</th><th>Description</th></tr>
<tr>
<td><tt>--Transform</tt></td>
<td><tt>InitCheckers</tt></td>
<td> Initialize the checking system used by transforms Checksum and CheckEnvironment </td>
</tr>
<tr>
<td><tt>--InitCheckersResponseKinds</tt></td>
<td><tt>abort, modifyGlobal, random, plugin</tt></td>
<td> Comma-separated list of ways to respond when a check fails. Default=abort.
<ul>
   <li> <tt>abort</tt> = Call the abort function
   <li> <tt>modifyGlobal</tt> = Make random modification to a global variable
   <li> <tt>random</tt> = Execute random bytes
   <li> <tt>plugin</tt> = Call one of the plugin responders
</ul>
</td>
</tr>
<tr>
<td><tt>--InitCheckersRespondWhen</tt></td>
<td><tt>immediately, delay</tt></td>
<td> Comma-separated list of when the response to a failed test should be issued. 
<ul>
   <li> <tt>immediately</tt> = Invoke the response action as soon as a check fails (will always trigger).
   <li> <tt>delay</tt> = Delay the response action until some later time (may or may not trigger, depending on subsequent control flow).
</ul>
</td>
</tr>
<tr>
<td><tt>--InitCheckersResponderCount</tt></td>
<td><tt><a href="top-level.html#INTSPEC">INTSPEC</a></tt></td>
<td> Number of responders to insert in the program. Default=1.</td>
</tr>
<tr>
<td><tt>--InitCheckersStateSize</tt></td>
<td><tt><a href="top-level.html#INTSPEC">INTSPEC</a></tt></td>
<td> Number of global variables that hold the check counts. Default=1.</td>
</tr>
<tr>
<td><tt>--InitCheckersFakeSize</tt></td>
<td><tt><a href="top-level.html#INTSPEC">INTSPEC</a></tt></td>
<td> Number of fake global variables that look like real state variables. Default=1.</td>
</tr>
<tr>
<td><tt>--InitCheckersThreshold</tt></td>
<td><tt><a href="top-level.html#INTSPEC">INTSPEC</a></tt></td>
<td> How many tests need to fail before a response is issued. Default=1.</td>
</tr>
<tr>
<td><tt>--InitCheckersStateEncodings</tt></td>
<td><tt>rnc, xor, list, plugin, none</tt></td>
<td> The encoding of the state in which to store successes and failures. Default=rnc.
<ul>
   <li> <tt>rnc</tt> = Use Residue Number Coding
   <li> <tt>xor</tt> = Use XOR coding
   <li> <tt>list</tt> = Use list encoding (not yet implemented)
   <li> <tt>plugin</tt> = Use plugins (not yet implemented)
   <li> <tt>none</tt> = Don't encode the state variables
</ul>
</td>
</tr>
<tr>
<td><tt>--InitCheckersFunctionsToInvokeResponders</tt></td>
<td><tt></tt></td>
<td> Comma-separated list of functions in which we can install responders. Default=None.</td>
</tr>


</table>
</center>
</div>
</div>
</section>

<br>

  <script src="assets/popper/popper.min.js"></script>
  <script src="assets/web/assets/jquery/jquery.min.js"></script>
  <script src="assets/bootstrap/js/bootstrap.min.js"></script>
  <script src="assets/tether/tether.min.js"></script>
  <script src="assets/smoothscroll/smooth-scroll.js"></script>
  <script src="assets/dropdown/js/nav-dropdown.js"></script>
  <script src="assets/dropdown/js/navbar-dropdown.js"></script>
  <script src="assets/touchswipe/jquery.touch-swipe.min.js"></script>
  <script src="assets/theme/js/script.js"></script>
  <script src="assets/prism/prism.js"></script>
  
</body>
</html>
