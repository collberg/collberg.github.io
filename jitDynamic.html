<!DOCTYPE html>
<html  >
<head>
  <!-- Site made with Mobirise Website Builder v4.10.10, https://mobirise.com -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v4.10.10, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/tigress-white-128x101.png" type="image/x-icon">
  <meta name="description" content="Web Site Builder Description">
  
  <title>JitDynamic</title>
  <link rel="preload" as="style" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
<link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="preload" as="style" href="assets/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="preload" as="style" href="assets/bootstrap/css/bootstrap-grid.min.css">
<link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="preload" as="style" href="assets/bootstrap/css/bootstrap-reboot.min.css">
<link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/tether/tether.min.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/animatecss/animate.min.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
 
<style>
body {
  background-color: #ffffff;
  color: #000000
}
section {
  background-color: #ffffff;
  color: #000000
}
p {
   color: #767676
}
h3 {
   color: #767676
}
</style>

</head>
<body>

  <section class="menu cid-rCFaEeaKON" once="menu" id="menu1-v">

    

    <nav class="navbar navbar-expand beta-menu navbar-dropdown align-items-center navbar-fixed-top navbar-toggleable-sm">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>
        <div class="menu-logo">
            <div class="navbar-brand">
                <span class="navbar-logo">
                    <a href="index.html">
                         <img src="assets/images/tigress-white-copy-154x122.png" alt="Mobirise" title="" style="height: 3.8rem;">
                    </a>
                </span>
                <span class="navbar-caption-wrap"><a class="navbar-caption text-white display-4" href="index.html">
                        Tigress</a></span>
            </div>
        </div>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true"><li class="nav-item">
                    <a class="nav-link link text-white display-4" href="index.html">
                        
                        Home</a>
                </li><li class="nav-item">
                    <a class="nav-link link text-white display-4" href="introduction.html">
                        
                        Introduction</a>
                </li><li class="nav-item"><a class="nav-link link text-white display-4" href="usage.html">Usage</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="transformations.html">Transformations</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="publications.html">Publications</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="FAQ.html">FAQ</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="consulting.html">Consulting/Training</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="about.html">About</a></li><li class="nav-item"><a class="nav-link link text-white display-4" href="contact.html">Contact</a></li></ul>
            
        </div>
    </nav>
</section>

<br><br><br><br>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5968" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">This transformation is similar to the Jit
transformation, except the jitted code is continuously modified and updated at runtime.</p></div></div></section>

<a class="anchor" id="background">&nbsp;</a>
<br>
<h3 align=center>Background</h3> 
 
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5969" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Our implementation is a generalization of a number of previously published schemes:</p></div></div></section>
<section class="mbr-section article content12 cid-rDNq15ll1q" id="content12-d"><div class="container"><div class="media-container-row"><div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
<ul>
   <li><a href="http://link.springer.com/chapter/10.1007%2F3-540-61996-8_49#page-1">Aucsmith, Tamper Resistant Software: An Implementation, IH'96</a>
   <li> <a href="https://securewww.esat.kuleuven.be/cosic/publications/article-1026.pdf">Cappaert, Preneel, et al. Towards Tamper Resistant Code Encryption Practive and Experience, ISPEC'08</a>
   <li><a href="http://link.springer.com/chapter/10.1007%2F11604938_15#page-1">Madou, et al., Software protection through dynamic code mutation, WISA'05</a>
   <li><a href="http://ieeexplore.ieee.org/xpl/login.jsp?tp=&arnumber=1245338&url=http%3A%2F%2Fieeexplore.ieee.org%2Fxpls%2Fabs_all.jsp%3Farnumber%3D1245338">Kanzaki, Exploiting Self-Modification Mechanism for Program Protection</a>
</ul>
</div></div></div></section>
Each of these schemes can be seen as a combination of two properties:
<section class="mbr-section article content11 cid-rDNq210J6O" id="content11-e"><div class="container"><div class="media-container-row"><div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
<ol>
   <li> the <em>level of granularity</em> at which the program is encoded and decoded
       (function-level, basic block-level, instruction-level, or byte-level), and 
   <li> the <em>codec</em> that determines how a function/block/etc. should be encoded
        and decoded.
</ol>
</div></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5970" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">For example, Aucsmith's scheme works on basic blocks and encodes two
blocks by xor:ing them with each other:</p></div></div></section>
<center>
<video  width="630" height="360" controls style="border:5px solid black;">
  <source src="tigress3-videos/aucksmith.m4v" type="video/mp4">
  Your browser does not support the video tag.
</video>
</center>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5971" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">pink-and-yellow striped block is the XOR of the pink and the yellow
blocks. Right before we want to execute the yellow block, the blue
block XORs the striped block with the pink block, and the yellow block
appears in cleartext and we can jump to it.<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5972" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">


<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5973" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Cappaert's scheme was originally designed to work at the
granularity of functions and encodes by encrypting using a standard
encryption algorithm, such as AES:</p></div></div></section>
<center>
<video  width="630" height="360" controls style="border:5px solid black;">
  <source src="tigress3-videos/cappaert.m4v" type="video/mp4">
  Your browser does not support the video tag.
</video>
</center>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5974" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff"> To avoid having to embed
keys directly in the executable where they are easy to find, this
scheme uses other blocks as the key. Here, the yellow block is
encrypted using the pink block as the key. Before we execute the
yellow block, the blue block decrypts it.  Then the yellow block
appears in cleartext, and we can jump to it.</p></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5975" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Kanzaki's scheme works at the
granularity of the raw bytes of the program and encodes/decodes
by patching holes left in the code:</p></div></div></section>
<center>
<video  width="630" height="360" controls style="border:5px solid black;">
  <source src="tigress3-videos/kanzaki.m4v" type="video/mp4">
  Your browser does not support the video tag.
</video>
</center>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5976" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Here, the blue block has a hole in it which the pink block
patches. Then control can continue with the blue block, after
which the yellow block will re-insert the hole.</p></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5977" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Madou's scheme was originally designed to work at the 
function level and encodes by letting blocks occupy the same space at 
runtime. A special PATCH function restores blocks before they are
needed:</p></div></div></section>
<center>
<video  width="630" height="360" controls style="border:5px solid black;">
  <source src="tigress3-videos/madou.m4v" type="video/mp4">
  Your browser does not support the video tag.
</video>
</center>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5978" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Here, the yellow and grey blocks both exist in the same memory location. 
The blue block decodes the yellow block by patching it; then jumps to it, 
then the brown block needs to execute the gray block, so it patches it, 
and then jumps to it.</p></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5979" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Our implementation of these schemes works at the granularity of basic
blocks and can be instantiated with arbitrary codecs (encoding/decoding
schemes):</p></div></div></section>
<center>
<video  width="630" height="360" controls style="border:5px solid black;">
  <source src="tigress3-videos/general.m4v" type="video/mp4">
  Your browser does not support the video tag.
</video>
</center>
<section class="mbr-section article content11 cid-rDNq210J6O" id="content11-e"><div class="container"><div class="media-container-row"><div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
<ol>
      <li> intially, before a function starts executing, (a subset of) its basic blocks 
           are encoded using one of the available codecs,</li>
      <li> prior to a block being executed it is decoded, and </li>
      <li> after a block has finished executing it is eventually re-encoded. </li>
</ol>
</div></div></div></section>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5980" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Note that in our implementation multiple encoding schemes can be used
within one function: some basic blocks may be encoded using Aucsmith's
scheme, some with Cappaert's scheme, etc.</p></div></div></section>

<a class="anchor" id="codecs">&nbsp;</a>
<br>
<h3 align=center>Dynamic Codecs</h3> 
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5981" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">We will add new codecs over time. Currently, the following are implemented:</p></div></div></section>

<center>
<table align=center  class="smalltab">
   <tr> 
      <th>Codec</th>
      <th>Description</th>
   </tr>

   <tr>
      <td>none</td>
      <td>No encoding</td>
   </tr>

   <tr>
      <td>ident</td>
      <td>No encoding</td>
   </tr>

   <tr>
      <td>ident_loop</td>
      <td>The identity encoding using a copy loop of primitive JIT instructions</td>
   </tr>

   <tr>
      <td>xor_transfer</td>
      <td>An xor encoding using a single xor JIT instruction</td>
   </tr>

   <tr>
      <td>xor_<em>byte/word/qword</em>_loop</td>
      <td>An xor encoding using a copy loop of byte/word/qwoard-size primitive JIT instructions </td>
   </tr>

   <tr>
      <td>xor_call</td>
      <td>Another xor encoding, but this one is outlined, calling a function which iterates over the 
          encoded block.</td>
   </tr>

   <tr>
      <td>xtea</td>
      <td>Encrypts/decrypts a block using the <a href="https://en.wikipedia.org/wiki/XTEA">xtea</a> cipher.
      </td>
   </tr>

   <tr>
      <td>stolen_<em>byte/short/word</em></td>
      <td>Encodes/decodes by filling in/leaving a hole in the basic block.
      </td>
   </tr>
</center>

<center>
<div style="mbr-text align-left pb-3 mbr-fonts-style display-7">
<table border style="background-color:#f5f5f5;overflow-x:auto;color:black;width:80%;">
    <colgroup>
       <col span="1" style="width: 20%;">
       <col span="1" style="width: 20%;">
       <col span="1" style="width: 60%;">
    </colgroup>
<tr><th>Option</th><th>Arguments</th><th>Description</th></tr>
<tr>
<td><tt>--Transform</tt></td>
<td><tt>JitDynamic</tt></td>
<td> Turn a function into a sequence of instructions that dynamically builds up the function at runtime, and continuously modifies them. </td>
</tr>
<tr>
<td><tt>--JitDynamicEncoding</tt></td>
<td><tt>hard, soft</tt></td>
<td> How the jitted instructions are encoded. Default=hard.
<ul>
   <li> <tt>hard</tt> = The jitted instructions are encoded as code.
   <li> <tt>soft</tt> = The jitted instructions are encoded as data (not implemented).
</ul>
</td>
</tr>
<tr>
<td><tt>--JitDynamicFrequency</tt></td>
<td><tt>INTSPEC</tt></td>
<td> How often to jit the code at runtime. 0=only the first time; n>0=Every n:th time the function is called. Default=0.</td>
</tr>
<tr>
<td><tt>--JitDynamicOptimizeBinary</tt></td>
<td><tt>INTSPEC</tt></td>
<td> Optimize the jitted binary code. 1=omit frame pointer, 2=omit unused assignments, 4=merge ADDs and MULs. Default=1|4=5.</td>
</tr>
<tr>
<td><tt>--JitDynamicImplicitFlowHandle</tt></td>
<td><tt>BOOLSPEC</tt></td>
<td> Insert implicit flow to the generated function handle. Default=false.</td>
</tr>
<tr>
<td><tt>--JitDynamicImplicitFlow</tt></td>
<td><tt>S-Expression</tt></td>
<td> The type of implicit flow to insert. See <tt>--AntiTaintAnalysisImplicitFlow</tt> for a description. Default=none.</td>
</tr>
<tr>
<td><tt>--JitDynamicObfuscateHandle</tt></td>
<td><tt>BOOLSPEC</tt></td>
<td> Add an opaque predicate to the generated function handle. Default=false.</td>
</tr>
<tr>
<td><tt>--JitDynamicObfuscateArguments</tt></td>
<td><tt>BOOLSPEC</tt></td>
<td> Add bogus arguments and opaque predicates to the jit_add_op function calls. Default=false.</td>
</tr>
<tr>
<td><tt>--JitDynamicDumpOpcodes</tt></td>
<td><tt>INTSPEC</tt></td>
<td> Print the jitter's bytecode. OR the numeric arguments together, or 0 for no dumping. Default=0.
<ul>
   <li> <tt>0x01</tt> = JIT_DEBUG_OPS
   <li> <tt>0x02</tt> = JIT_DEBUG_CODE
   <li> <tt>0x04</tt> = JIT_DEBUG_COMBINED
   <li> <tt>0x08</tt> = JIT_DEBUG_COMPILABLE
   <li> <tt>0x100</tt> = JIT_DEBUG_LOADS
   <li> <tt>0x200</tt> = JIT_DEBUG_ASSOC
   <li> <tt>0x400</tt> = JIT_DEBUG_LIVENESS
</ul>
</td>
</tr>
<tr>
<td><tt>--JitDynamicTrace</tt></td>
<td><tt>INTSPEC</tt></td>
<td> Insert runtime tracing of instructions. Set to 1 to turn it on. Default=0.</td>
</tr>
<tr>
<td><tt>--JitDynamicTraceExec</tt></td>
<td><tt>BOOLSPEC</tt></td>
<td> Annotate each instruction, showing from where it was generated, and the results of execution. Default=false.</td>
</tr>
<tr>
<td><tt>--JitDynamicDumpTree</tt></td>
<td><tt>BOOLSPEC</tt></td>
<td> Print the tree representation of the function, prior to generating the jitting code. Default=false.</td>
</tr>
<tr>
<td><tt>--JitDynamicAnnotateTree</tt></td>
<td><tt>BOOLSPEC</tt></td>
<td> Annotate the generated code with the corresponding intermediate tree code instructions. Default=false.</td>
</tr>
<tr>
<td><tt>--JitDynamicDumpIntermediate</tt></td>
<td><tt>BOOLSPEC</tt></td>
<td> Print the generated intermediate code at translation time. Default=false.</td>
</tr>
<tr>
<td><tt>--JitDynamicCodecs</tt></td>
<td><tt>none, ident, ident_loop, xor_transfer, xor_byte_loop, xor_word_loop, xor_qword_loop, xor_call, xor_call_trace, xtea, xtea_trace, stolen_byte, stolen_short, stolen_word</tt></td>
<td> How blocks should be encoded/decoded. Default=*.
<ul>
   <li> <tt>none</tt> = No encoding
   <li> <tt>ident</tt> = The identity encoding using a single copy JIT instruction
   <li> <tt>ident_loop</tt> = The identity encoding using a copy loop of primitive JIT instructions
   <li> <tt>xor_transfer</tt> = An xor encoding using a single xor JIT instruction
   <li> <tt>xor_byte_loop</tt> = An xor encoding using a copy loop of byte-size primitive JIT instructions
   <li> <tt>xor_word_loop</tt> = An xor encoding using a copy loop of word-size primitive JIT instructions
   <li> <tt>xor_qword_loop</tt> = An xor encoding using a copy loop of qword-size primitive JIT instructions
   <li> <tt>xor_call</tt> = An xor encoding calling a xor function
   <li> <tt>xor_call_trace</tt> = An xor encoding calling a xor function with tracing turned on (for debugging)
   <li> <tt>xtea</tt> = An xtea encryption
   <li> <tt>xtea_trace</tt> = An xtea encryption with tracing turned on (for debugging)
   <li> <tt>stolen_byte</tt> = A byte-sized stolen bytes encoding
   <li> <tt>stolen_short</tt> = A short-sized stolen bytes encoding
   <li> <tt>stolen_word</tt> = A word-sized stolen bytes encoding
</ul>
</td>
</tr>
<tr>
<td><tt>--JitDynamicKeyTypes</tt></td>
<td><tt>data, code</tt></td>
<td> Where the encoding/decoding key is stored (for xor and xtea encodings) Default=data.
<ul>
   <li> <tt>data</tt> = In the data segment
   <li> <tt>code</tt> = In the code segment (not implemented)
</ul>
</td>
</tr>
<tr>
<td><tt>--JitDynamicBlockFraction</tt></td>
<td><tt><em>FRACSPEC</em></tt></td>
<td> Fraction of the basic blocks in a function to encode Default=all.</td>
</tr>
<tr>
<td><tt>--JitDynamicRandomizeBlocks</tt></td>
<td><tt>BOOLSPEC</tt></td>
<td> Randomize the order of basic blocks Default=true.</td>
</tr>
<tr>
<td><tt>--JitDynamicReEncode</tt></td>
<td><tt>BOOLSPEC</tt></td>
<td> If true, blocks will be re-encoded after being executed. If false, blocks will be decoded once, and stay in cleartext. ('False' is not implemented; this option is always set to 'true'.) Default=true.</td>
</tr>
<tr>
<td><tt>--JitDynamicOptimize</tt></td>
<td><tt>BOOLSPEC</tt></td>
<td> Clean up the generated code by removing jumps-to-jumps. Default=true.</td>
</tr>
<tr>
<td><tt>--JitDynamicDumpCFG</tt></td>
<td><tt>BOOLSPEC</tt></td>
<td> Print the jitter's Control Flow Graph. This requires graphviz to be installed (the <tt>dot</tt> command is used). A number of pdf files get generated that shows the CFG at various stages of processing: <tt>CFGAfterInsertingAnnotations.pdf</tt>, <tt>CFGAfterSimplifyingJumps.pdf</tt>, <tt>CFGAfterTranslatingAnnotations.pdf</tt>, <tt>CFGBeforeInsertingAnnotations.pdf</tt>, <tt>CFGDumpingFunctionFinal.pdf</tt>, <tt>CFGDumpingFunctionInitial.pdf</tt>, <tt>CFGFixupIndirecJumps.pdf</tt>, <tt>CFGReplaceWithCompiledBlock.pdf</tt>, <tt>CFGSplitOutBranches.pdf</tt>, <tt>CFGSplitOutDataReferences.pdf</tt>, <tt>OriginalCFG.pdf</tt> Default=false.</td>
</tr>
<tr>
<td><tt>--JitDynamicTraceBlock</tt></td>
<td><tt>STRING</tt></td>
<td> Print out a message before each block is executed. (Not currently implemented.) Default="".</td>
</tr>
<tr>
<td><tt>--JitDynamicCompileCommand</tt></td>
<td><tt>STRING</tt></td>
<td> A string of the form "gcc -std=c99 -o %o %i", where "%i" will be replaced with the name of the input file and "%o" with the name of the output file. For example, if your program uses the math library, you should set <tt>--JitDynamicCompileCommand="gcc -std=c99 -o %o %i -lm". Default="gcc -std=c99 -o %o %i".</td>
</tr>
</table>
</div>

</center>

<a class="anchor" id="implementation">&nbsp;</a>
<br>
<h3 align=center>Implementation</h3> 
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5982" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">The Dynamic transformation follows the following steps to transform a function <code>F</code>:</p></div></div></section>
<section class="mbr-section article content11 cid-rDNq210J6O" id="content11-e"><div class="container"><div class="media-container-row"><div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
<ol>
   <li> Convert <code>F</code> to jitted code, identially to the 
        <a href="../../../transformPage/docs/jitter/index.html#usage">Jit</a>
        transformation;</li>
   <li> Construct a CFG from the jitted code;</li>
   <li> Transform the CFG, making certain instructions into their own blocks which
        will not be encoded:
<section class="mbr-section article content11 cid-rDNq210J6O" id="content11-e"><div class="container"><div class="media-container-row"><div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
<ol>
           <li> make every branch instruction a separate basic block;
           <li> make every instruction that references in-code data blocks a separate basic block;
           <li> add a level of indirection for indirect branches.
</ol>
</div></div></div></section>
   </li>
   <li> Add any necessary cipher functions to the executable;
   </li>
   <li> Decide, for every basic block, which codec it should use (if any);
   </li>
   <li> For each basic block that should be encoded, find allowable
        points within the CFG where decoders/encoders could safely be
        inserted;
   </li>
   <li> Insert the decoders/encoders at the chosen points;
   </li>
   <li> Generate a file <code>__dump__.c</code> with the jitting code
        for the function, plus instructions to dump the bytes for 
        each of the basic blocks we want to encode:
   </li>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">void foo(void) { 
    p6 = jit_init();
    jit_add_prolog(p6, & _1_foo8___foo, 0);
    localSize9 = jit_allocai(p6, 64L);
    jit_add_op(p6, JIT_ADD | 2, ((2 << 4) | (1 << 2)) | 3, (0 & 1) | (((0 & 3) << 1) | ((1 & 268435455) << 4)),
               (0 & 1) | (((2 & 3) << 1) | ((0 & 268435455) << 4)), (jit_value )(localSize9 + 44),
               0L, 0);
    jit_add_op(p6, JIT_MOV | 2, ((0 << 4) | (2 << 2)) | 3, (0 & 1) | (((0 & 3) << 1) | ((2 & 268435455) << 4)),
               (jit_value )(& printf), 0L, 0L, 0);
    jit_add_op(p6, JIT_ST | 1, ((0 << 4) | (1 << 2)) | 1, (0 & 1) | (((0 & 3) << 1) | ((1 & 268435455) << 4)),
               (0 & 1) | (((0 & 3) << 1) | ((2 & 268435455) << 4)), 0L, 8, 0);
    ...
    jit_generate_code(p6);
    DUMP_byte(1, p6, block_1_BEGIN11, block_1_END12);
    DUMP_byte(16, p6, block_16_BEGIN13, block_16_END14);
    DUMP_byte(18, p6, block_18_BEGIN15, block_18_END16);
    DUMP_byte(30, p6, block_30_BEGIN17, block_30_END18);
    DUMP_byte(31, p6, block_31_BEGIN19, block_31_END20);
    DUMP_byte(32, p6, block_32_BEGIN21, block_32_END22);
    ...
</code></pre>
   <li> Compile and run <code>__dump__.c</code>, generating a file <code>__dump__.blk</code>
        which has the raw bytes for every basic block:
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">BLOCK 1 byte 24 72 141 125 192 72 141 117 192 72 99 22 72 139 202 72 131 193 1 137 15 144 144 144 144  1 4 
BLOCK 16 byte 32 72 141 125 192 72 99 55 72 131 254 50 72 186 0 0 0 0 0 0 0 0 64 15 156 194 72 141 77 252 137 17 144  1 4 
BLOCK 18 byte 16 72 141 125 192 199 7 0 0 0 0 144 144 144 144 144 144  1 4 
BLOCK 30 byte 72 72 141 125 200 72 141 117 244 72 139 22 72 139 10 72 141 17 72 137 23 72 141 125 208 72 141 117 192 72 99 22 137 23 72 141 125 236 72 139 55 72 141 85 208 72 99 10 76 141 69 200 77 139 8 72 137 117 168 72 139 241 73 139 249 51 192 255 85 168 144 144 144  1 4 
BLOCK 31 byte 72 72 141 125 216 72 141 117 244 72 139 22 72 139 10 72 141 17 72 137 23 72 141 125 224 72 141 117 192 72 99 22 137 23 72 141 125 236 72 139 55 72 141 85 224 72 99 10 76 141 69 216 77 139 8 72 137 117 168 72 139 241 73 139 249 51 192 255 85 168 144 144 144  1 4 
BLOCK 32 byte 24 72 141 125 228 72 139 55 72 141 85 228 72 139 10 76 99 1 77 141 72 2 68 137 14  1 4 
</code></pre>
   </li>
   <li> Generate a file <code>__encode__.c</code> which contains all the raw bytes
        from <code>__dump__.blk</code> and all the codecs (xor, xtea, etc). Compile
        and run <code>__encode__.c</code>, generating a file <code>__encode__.blk</code>
        which contains all the encoded basic blocks:
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">BLOCK 1 byte  24 0 150 40 158 183 11 243 58 110 209 29 153 124 46 18 14 10 27 97 227 92 19 80 246  0
BLOCK 16 byte  32 76 189 227 92 247 77 242 199 113 84 187 65 8 176 115 94 49 181 11 5 154 173 46 183 141 132 129 145 165 99 158 217  0
BLOCK 18 byte  16 183 246 223 30 130 212 211 84 33 153 30 177 219 142 103 219  0
BLOCK 30 byte  72 213 130 51 242 153 48 73 211 125 101 119 66 161 239 137 109 50 235 72 137 167 130 85 136 0 185 44 108 170 111 249 215 63 46 224 91 112 130 253 192 83 135 162 17 240 216 183 168 214 131 163 112 239 26 149 190 81 126 175 148 107 71 116 148 119 92 26 141 131 168 174 5  0
BLOCK 31 byte  72 65 152 118 67 241 118 153 110 125 101 119 66 161 239 137 109 134 95 82 37 197 146 236 96 0 185 44 108 170 111 249 215 63 46 224 91 112 130 253 192 30 208 93 201 186 163 9 173 170 211 3 162 223 85 230 104 81 126 175 148 107 71 116 148 119 92 26 141 131 168 174 5  0
BLOCK 32 byte  24 127 82 142 1 193 218 46 10 34 19 201 130 55 248 122 67 145 230 144 218 219 35 49 3  0
</code></pre>
   <li> Replace the cleartext blocks in the CFG with their encoded 
        counterparts from <code>__encode__.blk</code>;
   </li>
   <li> Simplify jumps and turn the CFG back into C source.
   </li>
</ol>
</div></div></div></section>

<a class="anchor" id="example">&nbsp;</a>
<br>
<h3 align=center>Example</h3> 
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5983" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">This function:</p></div></div></section>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">void foo4() {
  if (g) {
     g+=2;
  };
}
</code></pre>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5984" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">turns into this CFG:</p></div></div></section>
<center><img width="400px" src="tigress3-images/OriginalCFG.png"></center>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5985" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">We then find points where blocks can be encoded and decoded, and
insert <em>annotations</em> (left arrows for encode, right arrows
for decode) into the CFG:</p></div></div></section>
   <center><img width="400px" src="tigress3-images/CFGAfterInsertingAnnotations.png"></center>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5986" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff"> In this trivial CFG, the decoders/encoders are inserted at the beginning
and end of the function but, in general, they are inserted randomly, subject
to the constraint that when control reaches a block it should be in cleartext,
and when the function returns every block should be encoded.</p></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5987" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">We next translate these annotations into the actual decoders/encoders
(here, calls to the xtea decipher/encipher functions):</p></div></div></section>
   <center><img width="400px" src="tigress3-images/CFGAfterTranslatingAnnotations.png"></center>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5988" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Finally, we replace cleartext code blocks with the corresponding 
encoded blocks:</p></div></div></section>
   <center><img width="400px" src="tigress3-images/CFGReplaceWithCompiledBlock.png"></center>


<a class="anchor" id="usage">&nbsp;</a>
<br>
<h3 align=center>Usage</h3> 
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5989" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">The Dynamic transformation is built on the Jittransformation and
therefore the Jit's usage applies to the Dynamic transformation as
well. In particular, you have to add the appropriate directives to the
top of your C source file to include the jitter.</p></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5990" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">A typical invokation of Tigress would look like this:</p></div></div></section>
<pre style="text-align:left;background-color:#f0f0f0;display:inline-block;padding:20px;border:1px solid black;"><code contenteditable spellcheck="false">tigress \
   --Transform=JitDynamic \
      --Functions=foo \
      --JitDynamicCodecs=xtea \
      --JitDynamicDumpCFG=true \
      --JitDynamicBlockFraction=%50 \
      --out=f_out.c f.c
</code></pre>

<a class="anchor" id="issues">&nbsp;</a>
<br>
<h3 align=center>Issues</h3>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5991" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">The issues for the Jit transformation apply to the Dynamic transformation as well.</p></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5992" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff"> Recursion is an issue for dynamic obfuscation. In general, whenever you call a 
function it has to be in its fully encoded form. This presents a problem if a function
calls itself (directly or through a recursive call chain) from somewhere in the middle
where some blocks are encoded and some are in cleartext. For simple recursive procedures
we detect this and</p></div></div></section>
<section class="mbr-section article content12 cid-rDNq15ll1q" id="content12-d"><div class="container"><div class="media-container-row"><div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
<ul>
   <li> blocks that contain (direct or indirect) recursive calls will not be encoded; </li>
   <li> encoders/decoders are placed such that recursive calls won't leave any blocks in cleartext.</li>
</ul>
</div></div></div></section>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5993" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">In certain situations we won't detect the recursion and this will lead to bad code being
generated:</p></div></div></section>
<section class="mbr-section article content12 cid-rDNq15ll1q" id="content12-d"><div class="container"><div class="media-container-row"><div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
<ul>
   <li> if a function is part of a recursive callcycle where one of the
        calls is through a function pointer; </li>
   <li> if your program contains multiple mutually recursive functions and
        you try to obfuscate more than one of them.  </li>
</ul>
</div></div></div></section>
<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5994" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">The good news is that an obfuscated program that violates these rules will probably crash 
quickly since the resulting code will try to execute an encoded block.</p></div></div></section>

<section class="engine"><a href="https://mobirise.info/l">free web templates</a></section><section class="header9 cid-c5995" id="header9-h"> <div class="container"><div class="media-container-column mbr-white"><p class="mbr-text align-left pb-3 mbr-fonts-style display-7" style="background-color:#ffffff">Performance of Tigress itself can be a problem. The issue is finding the positions 
in the control flow graph where we can insert codecs. There are two problems:</p></div></div></section>
<section class="mbr-section article content12 cid-rDNq15ll1q" id="content12-d"><div class="container"><div class="media-container-row"><div class="mbr-text counter-container col-12 col-md-8 mbr-fonts-style display-7">
<ul>
   <li> We generate a large number of path queries on the CFG. 
        Try <code>--Verbosity=5</code> to see what's happening, 
        and then set <code>--JitDynamicBlockFraction=%10</code>, for example, to cut down on
        the number of blocks that get encoded.  </li>
   <li> Avoid the virtualize transformation with a direct threading dispatch, since
        this results in large graphs with many cliques (each instruction handler can 
        jump to every other instruction handler...) and the path queries become very slow. </li>
</ul>
</div></div></div></section>

  <script src="assets/popper/popper.min.js"></script>
  <script src="assets/bootstrap/js/bootstrap.min.js"></script>
  <script async src="assets/tether/tether.min.js"></script>
  <script async src="assets/dropdown/js/nav-dropdown.js"></script>
  <script async src="assets/dropdown/js/navbar-dropdown.js"></script>
  <script async src="assets/touchswipe/jquery.touch-swipe.min.js"></script>
  <script async src="assets/viewportchecker/jquery.viewportchecker.js"></script>
  <script async src="assets/smoothscroll/smooth-scroll.js"></script>
  <script async src="assets/theme/js/script.js"></script>
  
  
  <input name="animation" type="hidden">
  
</body>
</html>
